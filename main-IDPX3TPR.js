import{$ as Io,$a as Yn,$b as cr,A as Pe,Aa as Nt,Ab as $t,Ac as Er,B as Co,Ba as Ht,Bb as er,Bc as kr,C as vo,Ca as Lo,Cb as bn,Cc as Ir,D as yo,Da as g,Db as Xn,Dc as vn,E as dn,Ea as me,Eb as Kn,Ec as Ae,F as xo,Fa as W,Fb as Jn,Fc as Ke,G as en,Ga as Zt,Gb as tr,Gc as Mr,H as wo,Ha as qt,Hb as ei,Hc as pt,I as _t,Ia as zt,Ib as Ge,Ic as be,J as mn,Ja as gn,Jb as $e,Jc as Xt,K as To,Ka as No,Kb as ti,Kc as yn,L as So,La as Fo,Lb as nr,Lc as li,M as nt,Ma as Ao,Mb as Ye,Mc as xn,N as De,Na as ve,Nb as ni,Nc as St,O as Ue,Oa as nn,Ob as ir,Oc as pi,P as fn,Pa as On,Pb as st,Pc as Or,Q as tn,Qa as x,Qb as at,Qc as wn,R as Eo,Ra as M,Rb as ii,Rc as ut,S as Se,Sa as le,Sb as Fe,Sc as ui,T as Ee,Ta as on,Tb as Cn,Tc as di,U as Zn,Ua as Ni,Ub as ct,Uc as Be,V as Re,Va as $n,Vb as oi,Vc as Pr,W as Dt,Wa as qe,Wb as or,X as ko,Xa as Ie,Xb as rr,Y as te,Ya as we,Yb as sr,Z as ne,Za as it,Zb as ar,_ as hn,_a as ot,_b as ri,a as pn,aa as Mo,ab as ze,ac as lr,b as tt,ba as Oo,bb as rt,bc as pr,c as Jt,ca as qn,cb as Bo,cc as ur,d as Ze,da as zn,db as jo,dc as dr,e as Mn,ea as a,eb as Fi,ec as mr,f as fo,fa as Gn,fb as Qn,fc as fr,g as Pt,ga as Po,gb as Vo,gc as lt,h as An,ha as E,hb as Uo,hc as hr,i as Bn,ia as ie,ib as Wo,ic as Qe,j as Ne,ja as ke,jb as Ho,jc as gr,k as Je,ka as Do,kb as Zo,kc as si,l as jn,la as P,lb as qo,lc as _r,m as F,ma as Ro,mb as Ai,mc as ai,n as un,na as Ri,nb as wt,nc as Yt,o as et,oa as Li,ob as zo,oc as Qt,p as ho,pa as p,pb as We,pc as Xe,q as Vn,qa as c,qb as Gt,qc as ci,r as Un,ra as d,rb as Go,rc as ee,s as Wt,sa as R,sb as $o,sc as br,t as se,ta as yt,tb as Yo,tc as Cr,u as Wn,ua as xt,ub as Qo,uc as vr,v as Hn,va as de,vb as Xo,vc as yr,w as go,wa as A,wb as _n,wc as xr,x as _o,xa as b,xb as Ko,xc as wr,y as Ce,ya as Rt,yb as Tt,yc as Tr,z as bo,za as Lt,zb as Jo,zc as Sr}from"./chunk-2JUPZ3ZJ.js";import"./chunk-5SUNX3RQ.js";import"./chunk-QUJFQN2Y.js";import"./chunk-FZ2QELI6.js";import"./chunk-G2BRJ6OE.js";import"./chunk-KQXQAFMG.js";import"./chunk-WVHTM5RI.js";import"./chunk-IN6HLDFE.js";import"./chunk-GIMG75PD.js";import"./chunk-2FQKSNO5.js";import"./chunk-IXGZJI4W.js";import"./chunk-3D2RNEUG.js";import"./chunk-QNCTVU3D.js";import"./chunk-NDIIV54U.js";import"./chunk-Y6CA27CD.js";import"./chunk-NA4VR4NT.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-PEFHW6RW.js";import"./chunk-CKP3SGE2.js";import"./chunk-OAUZBEWA.js";import{a as Kt,b as mo}from"./chunk-B7O3QC5Z.js";var Et=globalThis;function dt(t){return(Et.__Zone_symbol_prefix||"__zone_symbol__")+t}function Ns(){let t=Et.performance;function e(Q){t&&t.mark&&t.mark(Q)}function i(Q,D){t&&t.measure&&t.measure(Q,D)}e("Zone");let n=(()=>{class Q{static __symbol__=dt;static assertZonePatched(){if(Et.Promise!==Y.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")}static get root(){let u=Q.current;for(;u.parent;)u=u.parent;return u}static get current(){return Z.zone}static get currentTask(){return $}static __load_patch(u,f,B=!1){if(Y.hasOwnProperty(u)){let q=Et[dt("forceDuplicateZoneCheck")]===!0;if(!B&&q)throw Error("Already loaded patch: "+u)}else if(!Et["__Zone_disable_"+u]){let q="Zone:"+u;e(q),Y[u]=f(Et,Q,z),i(q,q)}}get parent(){return this._parent}get name(){return this._name}_parent;_name;_properties;_zoneDelegate;constructor(u,f){this._parent=u,this._name=f?f.name||"unnamed":"<root>",this._properties=f&&f.properties||{},this._zoneDelegate=new r(this,this._parent&&this._parent._zoneDelegate,f)}get(u){let f=this.getZoneWith(u);if(f)return f._properties[u]}getZoneWith(u){let f=this;for(;f;){if(f._properties.hasOwnProperty(u))return f;f=f._parent}return null}fork(u){if(!u)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,u)}wrap(u,f){if(typeof u!="function")throw new Error("Expecting function got: "+u);let B=this._zoneDelegate.intercept(this,u,f),q=this;return function(){return q.runGuarded(B,this,arguments,f)}}run(u,f,B,q){Z={parent:Z,zone:this};try{return this._zoneDelegate.invoke(this,u,f,B,q)}finally{Z=Z.parent}}runGuarded(u,f=null,B,q){Z={parent:Z,zone:this};try{try{return this._zoneDelegate.invoke(this,u,f,B,q)}catch(xe){if(this._zoneDelegate.handleError(this,xe))throw xe}}finally{Z=Z.parent}}runTask(u,f,B){if(u.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(u.zone||U).name+"; Execution: "+this.name+")");let q=u,{type:xe,data:{isPeriodic:re=!1,isRefreshable:Vt=!1}={}}=u;if(u.state===ae&&(xe===_e||xe===L))return;let Mt=u.state!=ce;Mt&&q._transitionTo(ce,k);let Ot=$;$=q,Z={parent:Z,zone:this};try{xe==L&&u.data&&!re&&!Vt&&(u.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,q,f,B)}catch(ht){if(this._zoneDelegate.handleError(this,ht))throw ht}}finally{let ht=u.state;if(ht!==ae&&ht!==Te)if(xe==_e||re||Vt&&ht===j)Mt&&q._transitionTo(k,ce,j);else{let S=q._zoneDelegates;this._updateTaskCount(q,-1),Mt&&q._transitionTo(ae,ce,ae),Vt&&(q._zoneDelegates=S)}Z=Z.parent,$=Ot}}scheduleTask(u){if(u.zone&&u.zone!==this){let B=this;for(;B;){if(B===u.zone)throw Error(`can not reschedule task to ${this.name} which is descendants of the original zone ${u.zone.name}`);B=B.parent}}u._transitionTo(j,ae);let f=[];u._zoneDelegates=f,u._zone=this;try{u=this._zoneDelegate.scheduleTask(this,u)}catch(B){throw u._transitionTo(Te,j,ae),this._zoneDelegate.handleError(this,B),B}return u._zoneDelegates===f&&this._updateTaskCount(u,1),u.state==j&&u._transitionTo(k,j),u}scheduleMicroTask(u,f,B,q){return this.scheduleTask(new s(fe,u,f,B,q,void 0))}scheduleMacroTask(u,f,B,q,xe){return this.scheduleTask(new s(L,u,f,B,q,xe))}scheduleEventTask(u,f,B,q,xe){return this.scheduleTask(new s(_e,u,f,B,q,xe))}cancelTask(u){if(u.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(u.zone||U).name+"; Execution: "+this.name+")");if(!(u.state!==k&&u.state!==ce)){u._transitionTo(ue,k,ce);try{this._zoneDelegate.cancelTask(this,u)}catch(f){throw u._transitionTo(Te,ue),this._zoneDelegate.handleError(this,f),f}return this._updateTaskCount(u,-1),u._transitionTo(ae,ue),u.runCount=-1,u}}_updateTaskCount(u,f){let B=u._zoneDelegates;f==-1&&(u._zoneDelegates=null);for(let q=0;q<B.length;q++)B[q]._updateTaskCount(u.type,f)}}return Q})(),o={name:"",onHasTask:(Q,D,u,f)=>Q.hasTask(u,f),onScheduleTask:(Q,D,u,f)=>Q.scheduleTask(u,f),onInvokeTask:(Q,D,u,f,B,q)=>Q.invokeTask(u,f,B,q),onCancelTask:(Q,D,u,f)=>Q.cancelTask(u,f)};class r{get zone(){return this._zone}_zone;_taskCounts={microTask:0,macroTask:0,eventTask:0};_parentDelegate;_forkDlgt;_forkZS;_forkCurrZone;_interceptDlgt;_interceptZS;_interceptCurrZone;_invokeDlgt;_invokeZS;_invokeCurrZone;_handleErrorDlgt;_handleErrorZS;_handleErrorCurrZone;_scheduleTaskDlgt;_scheduleTaskZS;_scheduleTaskCurrZone;_invokeTaskDlgt;_invokeTaskZS;_invokeTaskCurrZone;_cancelTaskDlgt;_cancelTaskZS;_cancelTaskCurrZone;_hasTaskDlgt;_hasTaskDlgtOwner;_hasTaskZS;_hasTaskCurrZone;constructor(D,u,f){this._zone=D,this._parentDelegate=u,this._forkZS=f&&(f&&f.onFork?f:u._forkZS),this._forkDlgt=f&&(f.onFork?u:u._forkDlgt),this._forkCurrZone=f&&(f.onFork?this._zone:u._forkCurrZone),this._interceptZS=f&&(f.onIntercept?f:u._interceptZS),this._interceptDlgt=f&&(f.onIntercept?u:u._interceptDlgt),this._interceptCurrZone=f&&(f.onIntercept?this._zone:u._interceptCurrZone),this._invokeZS=f&&(f.onInvoke?f:u._invokeZS),this._invokeDlgt=f&&(f.onInvoke?u:u._invokeDlgt),this._invokeCurrZone=f&&(f.onInvoke?this._zone:u._invokeCurrZone),this._handleErrorZS=f&&(f.onHandleError?f:u._handleErrorZS),this._handleErrorDlgt=f&&(f.onHandleError?u:u._handleErrorDlgt),this._handleErrorCurrZone=f&&(f.onHandleError?this._zone:u._handleErrorCurrZone),this._scheduleTaskZS=f&&(f.onScheduleTask?f:u._scheduleTaskZS),this._scheduleTaskDlgt=f&&(f.onScheduleTask?u:u._scheduleTaskDlgt),this._scheduleTaskCurrZone=f&&(f.onScheduleTask?this._zone:u._scheduleTaskCurrZone),this._invokeTaskZS=f&&(f.onInvokeTask?f:u._invokeTaskZS),this._invokeTaskDlgt=f&&(f.onInvokeTask?u:u._invokeTaskDlgt),this._invokeTaskCurrZone=f&&(f.onInvokeTask?this._zone:u._invokeTaskCurrZone),this._cancelTaskZS=f&&(f.onCancelTask?f:u._cancelTaskZS),this._cancelTaskDlgt=f&&(f.onCancelTask?u:u._cancelTaskDlgt),this._cancelTaskCurrZone=f&&(f.onCancelTask?this._zone:u._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;let B=f&&f.onHasTask,q=u&&u._hasTaskZS;(B||q)&&(this._hasTaskZS=B?f:o,this._hasTaskDlgt=u,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=this._zone,f.onScheduleTask||(this._scheduleTaskZS=o,this._scheduleTaskDlgt=u,this._scheduleTaskCurrZone=this._zone),f.onInvokeTask||(this._invokeTaskZS=o,this._invokeTaskDlgt=u,this._invokeTaskCurrZone=this._zone),f.onCancelTask||(this._cancelTaskZS=o,this._cancelTaskDlgt=u,this._cancelTaskCurrZone=this._zone))}fork(D,u){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,D,u):new n(D,u)}intercept(D,u,f){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,D,u,f):u}invoke(D,u,f,B,q){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,D,u,f,B,q):u.apply(f,B)}handleError(D,u){return this._handleErrorZS?this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,D,u):!0}scheduleTask(D,u){let f=u;if(this._scheduleTaskZS)this._hasTaskZS&&f._zoneDelegates.push(this._hasTaskDlgtOwner),f=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,D,u),f||(f=u);else if(u.scheduleFn)u.scheduleFn(u);else if(u.type==fe)O(u);else throw new Error("Task is missing scheduleFn.");return f}invokeTask(D,u,f,B){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,D,u,f,B):u.callback.apply(f,B)}cancelTask(D,u){let f;if(this._cancelTaskZS)f=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,D,u);else{if(!u.cancelFn)throw Error("Task is not cancelable");f=u.cancelFn(u)}return f}hasTask(D,u){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,D,u)}catch(f){this.handleError(D,f)}}_updateTaskCount(D,u){let f=this._taskCounts,B=f[D],q=f[D]=B+u;if(q<0)throw new Error("More tasks executed then were scheduled.");if(B==0||q==0){let xe={microTask:f.microTask>0,macroTask:f.macroTask>0,eventTask:f.eventTask>0,change:D};this.hasTask(this._zone,xe)}}}class s{type;source;invoke;callback;data;scheduleFn;cancelFn;_zone=null;runCount=0;_zoneDelegates=null;_state="notScheduled";constructor(D,u,f,B,q,xe){if(this.type=D,this.source=u,this.data=B,this.scheduleFn=q,this.cancelFn=xe,!f)throw new Error("callback is not defined");this.callback=f;let re=this;D===_e&&B&&B.useG?this.invoke=s.invokeTask:this.invoke=function(){return s.invokeTask.call(Et,re,this,arguments)}}static invokeTask(D,u,f){D||(D=this),Ve++;try{return D.runCount++,D.zone.runTask(D,u,f)}finally{Ve==1&&H(),Ve--}}get zone(){return this._zone}get state(){return this._state}cancelScheduleRequest(){this._transitionTo(ae,j)}_transitionTo(D,u,f){if(this._state===u||this._state===f)this._state=D,D==ae&&(this._zoneDelegates=null);else throw new Error(`${this.type} '${this.source}': can not transition to '${D}', expecting state '${u}'${f?" or '"+f+"'":""}, was '${this._state}'.`)}toString(){return this.data&&typeof this.data.handleId<"u"?this.data.handleId.toString():Object.prototype.toString.call(this)}toJSON(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}}}let m=dt("setTimeout"),l=dt("Promise"),_=dt("then"),y=[],I=!1,C;function v(Q){if(C||Et[l]&&(C=Et[l].resolve(0)),C){let D=C[_];D||(D=C.then),D.call(C,Q)}else Et[m](Q,0)}function O(Q){Ve===0&&y.length===0&&v(H),Q&&y.push(Q)}function H(){if(!I){for(I=!0;y.length;){let Q=y;y=[];for(let D=0;D<Q.length;D++){let u=Q[D];try{u.zone.runTask(u,null,null)}catch(f){z.onUnhandledError(f)}}}z.microtaskDrainDone(),I=!1}}let U={name:"NO ZONE"},ae="notScheduled",j="scheduling",k="scheduled",ce="running",ue="canceling",Te="unknown",fe="microTask",L="macroTask",_e="eventTask",Y={},z={symbol:dt,currentZoneFrame:()=>Z,onUnhandledError:ye,microtaskDrainDone:ye,scheduleMicroTask:O,showUncaughtError:()=>!n[dt("ignoreConsoleErrorUncaughtError")],patchEventTarget:()=>[],patchOnProperties:ye,patchMethod:()=>ye,bindArguments:()=>[],patchThen:()=>ye,patchMacroTask:()=>ye,patchEventPrototype:()=>ye,isIEOrEdge:()=>!1,getGlobalObjects:()=>{},ObjectDefineProperty:()=>ye,ObjectGetOwnPropertyDescriptor:()=>{},ObjectCreate:()=>{},ArraySlice:()=>[],patchClass:()=>ye,wrapWithCurrentZone:()=>ye,filterProperties:()=>[],attachOriginToPatched:()=>ye,_redefineProperty:()=>ye,patchCallbacks:()=>ye,nativeScheduleMicroTask:v},Z={parent:null,zone:new n(null,null)},$=null,Ve=0;function ye(){}return i("Zone","Zone"),n}function Fs(){let t=globalThis,e=t[dt("forceDuplicateZoneCheck")]===!0;if(t.Zone&&(e||typeof t.Zone.__symbol__!="function"))throw new Error("Zone already loaded.");return t.Zone??=Ns(),t.Zone}var Dn=Object.getOwnPropertyDescriptor,Wi=Object.defineProperty,Hi=Object.getPrototypeOf,As=Object.create,Bs=Array.prototype.slice,Zi="addEventListener",qi="removeEventListener",Bi=dt(Zi),ji=dt(qi),Ft="true",At="false",Rn=dt("");function zi(t,e){return Zone.current.wrap(t,e)}function Gi(t,e,i,n,o){return Zone.current.scheduleMacroTask(t,e,i,n,o)}var pe=dt,hi=typeof window<"u",Ln=hi?window:void 0,Me=hi&&Ln||globalThis,js="removeAttribute";function $i(t,e){for(let i=t.length-1;i>=0;i--)typeof t[i]=="function"&&(t[i]=zi(t[i],e+"_"+i));return t}function Vs(t,e){let i=t.constructor.name;for(let n=0;n<e.length;n++){let o=e[n],r=t[o];if(r){let s=Dn(t,o);if(!Br(s))continue;t[o]=(m=>{let l=function(){return m.apply(this,$i(arguments,i+"."+o))};return jt(l,m),l})(r)}}}function Br(t){return t?t.writable===!1?!1:!(typeof t.get=="function"&&typeof t.set>"u"):!0}var jr=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,gi=!("nw"in Me)&&typeof Me.process<"u"&&Me.process.toString()==="[object process]",Yi=!gi&&!jr&&!!(hi&&Ln.HTMLElement),Vr=typeof Me.process<"u"&&Me.process.toString()==="[object process]"&&!jr&&!!(hi&&Ln.HTMLElement),fi={},Us=pe("enable_beforeunload"),Dr=function(t){if(t=t||Me.event,!t)return;let e=fi[t.type];e||(e=fi[t.type]=pe("ON_PROPERTY"+t.type));let i=this||t.target||Me,n=i[e],o;if(Yi&&i===Ln&&t.type==="error"){let r=t;o=n&&n.call(this,r.message,r.filename,r.lineno,r.colno,r.error),o===!0&&t.preventDefault()}else o=n&&n.apply(this,arguments),t.type==="beforeunload"&&Me[Us]&&typeof o=="string"?t.returnValue=o:o!=null&&!o&&t.preventDefault();return o};function Rr(t,e,i){let n=Dn(t,e);if(!n&&i&&Dn(i,e)&&(n={enumerable:!0,configurable:!0}),!n||!n.configurable)return;let o=pe("on"+e+"patched");if(t.hasOwnProperty(o)&&t[o])return;delete n.writable,delete n.value;let r=n.get,s=n.set,m=e.slice(2),l=fi[m];l||(l=fi[m]=pe("ON_PROPERTY"+m)),n.set=function(_){let y=this;if(!y&&t===Me&&(y=Me),!y)return;typeof y[l]=="function"&&y.removeEventListener(m,Dr),s?.call(y,null),y[l]=_,typeof _=="function"&&y.addEventListener(m,Dr,!1)},n.get=function(){let _=this;if(!_&&t===Me&&(_=Me),!_)return null;let y=_[l];if(y)return y;if(r){let I=r.call(this);if(I)return n.set.call(this,I),typeof _[js]=="function"&&_.removeAttribute(e),I}return null},Wi(t,e,n),t[o]=!0}function Ur(t,e,i){if(e)for(let n=0;n<e.length;n++)Rr(t,"on"+e[n],i);else{let n=[];for(let o in t)o.slice(0,2)=="on"&&n.push(o);for(let o=0;o<n.length;o++)Rr(t,n[o],i)}}var bt=pe("originalInstance");function Pn(t){let e=Me[t];if(!e)return;Me[pe(t)]=e,Me[t]=function(){let o=$i(arguments,t);switch(o.length){case 0:this[bt]=new e;break;case 1:this[bt]=new e(o[0]);break;case 2:this[bt]=new e(o[0],o[1]);break;case 3:this[bt]=new e(o[0],o[1],o[2]);break;case 4:this[bt]=new e(o[0],o[1],o[2],o[3]);break;default:throw new Error("Arg list too long.")}},jt(Me[t],e);let i=new e(function(){}),n;for(n in i)t==="XMLHttpRequest"&&n==="responseBlob"||(function(o){typeof i[o]=="function"?Me[t].prototype[o]=function(){return this[bt][o].apply(this[bt],arguments)}:Wi(Me[t].prototype,o,{set:function(r){typeof r=="function"?(this[bt][o]=zi(r,t+"."+o),jt(this[bt][o],r)):this[bt][o]=r},get:function(){return this[bt][o]}})})(n);for(n in e)n!=="prototype"&&e.hasOwnProperty(n)&&(Me[t][n]=e[n])}function Bt(t,e,i){let n=t;for(;n&&!n.hasOwnProperty(e);)n=Hi(n);!n&&t[e]&&(n=t);let o=pe(e),r=null;if(n&&(!(r=n[o])||!n.hasOwnProperty(o))){r=n[o]=n[e];let s=n&&Dn(n,e);if(Br(s)){let m=i(r,o,e);n[e]=function(){return m(this,arguments)},jt(n[e],r)}}return r}function Ws(t,e,i){let n=null;function o(r){let s=r.data;return s.args[s.cbIdx]=function(){r.invoke.apply(this,arguments)},n.apply(s.target,s.args),r}n=Bt(t,e,r=>function(s,m){let l=i(s,m);return l.cbIdx>=0&&typeof m[l.cbIdx]=="function"?Gi(l.name,m[l.cbIdx],l,o):r.apply(s,m)})}function jt(t,e){t[pe("OriginalDelegate")]=e}var Lr=!1,Vi=!1;function Hs(){if(Lr)return Vi;Lr=!0;try{let t=Ln.navigator.userAgent;(t.indexOf("MSIE ")!==-1||t.indexOf("Trident/")!==-1||t.indexOf("Edge/")!==-1)&&(Vi=!0)}catch{}return Vi}function Nr(t){return typeof t=="function"}function Fr(t){return typeof t=="number"}var Zs={useG:!0},mt={},Wr={},Hr=new RegExp("^"+Rn+"(\\w+)(true|false)$"),Zr=pe("propagationStopped");function qr(t,e){let i=(e?e(t):t)+At,n=(e?e(t):t)+Ft,o=Rn+i,r=Rn+n;mt[t]={},mt[t][At]=o,mt[t][Ft]=r}function qs(t,e,i,n){let o=n&&n.add||Zi,r=n&&n.rm||qi,s=n&&n.listeners||"eventListeners",m=n&&n.rmAll||"removeAllListeners",l=pe(o),_="."+o+":",y="prependListener",I="."+y+":",C=function(j,k,ce){if(j.isRemoved)return;let ue=j.callback;typeof ue=="object"&&ue.handleEvent&&(j.callback=L=>ue.handleEvent(L),j.originalDelegate=ue);let Te;try{j.invoke(j,k,[ce])}catch(L){Te=L}let fe=j.options;if(fe&&typeof fe=="object"&&fe.once){let L=j.originalDelegate?j.originalDelegate:j.callback;k[r].call(k,ce.type,L,fe)}return Te};function v(j,k,ce){if(k=k||t.event,!k)return;let ue=j||k.target||t,Te=ue[mt[k.type][ce?Ft:At]];if(Te){let fe=[];if(Te.length===1){let L=C(Te[0],ue,k);L&&fe.push(L)}else{let L=Te.slice();for(let _e=0;_e<L.length&&!(k&&k[Zr]===!0);_e++){let Y=C(L[_e],ue,k);Y&&fe.push(Y)}}if(fe.length===1)throw fe[0];for(let L=0;L<fe.length;L++){let _e=fe[L];e.nativeScheduleMicroTask(()=>{throw _e})}}}let O=function(j){return v(this,j,!1)},H=function(j){return v(this,j,!0)};function U(j,k){if(!j)return!1;let ce=!0;k&&k.useG!==void 0&&(ce=k.useG);let ue=k&&k.vh,Te=!0;k&&k.chkDup!==void 0&&(Te=k.chkDup);let fe=!1;k&&k.rt!==void 0&&(fe=k.rt);let L=j;for(;L&&!L.hasOwnProperty(o);)L=Hi(L);if(!L&&j[o]&&(L=j),!L||L[l])return!1;let _e=k&&k.eventNameToString,Y={},z=L[l]=L[o],Z=L[pe(r)]=L[r],$=L[pe(s)]=L[s],Ve=L[pe(m)]=L[m],ye;k&&k.prepend&&(ye=L[pe(k.prepend)]=L[k.prepend]);function Q(h,T){return T?typeof h=="boolean"?{capture:h,passive:!0}:h?typeof h=="object"&&h.passive!==!1?mo(Kt({},h),{passive:!0}):h:{passive:!0}:h}let D=function(h){if(!Y.isExisting)return z.call(Y.target,Y.eventName,Y.capture?H:O,Y.options)},u=function(h){if(!h.isRemoved){let T=mt[h.eventName],V;T&&(V=T[h.capture?Ft:At]);let G=V&&h.target[V];if(G){for(let N=0;N<G.length;N++)if(G[N]===h){G.splice(N,1),h.isRemoved=!0,h.removeAbortListener&&(h.removeAbortListener(),h.removeAbortListener=null),G.length===0&&(h.allRemoved=!0,h.target[V]=null);break}}}if(h.allRemoved)return Z.call(h.target,h.eventName,h.capture?H:O,h.options)},f=function(h){return z.call(Y.target,Y.eventName,h.invoke,Y.options)},B=function(h){return ye.call(Y.target,Y.eventName,h.invoke,Y.options)},q=function(h){return Z.call(h.target,h.eventName,h.invoke,h.options)},xe=ce?D:f,re=ce?u:q,Vt=function(h,T){let V=typeof T;return V==="function"&&h.callback===T||V==="object"&&h.originalDelegate===T},Mt=k?.diff||Vt,Ot=Zone[pe("UNPATCHED_EVENTS")],ht=t[pe("PASSIVE_EVENTS")];function S(h){if(typeof h=="object"&&h!==null){let T=Kt({},h);return h.signal&&(T.signal=h.signal),T}return h}let w=function(h,T,V,G,N=!1,X=!1){return function(){let K=this||t,J=arguments[0];k&&k.transferEventName&&(J=k.transferEventName(J));let he=arguments[1];if(!he)return h.apply(this,arguments);if(gi&&J==="uncaughtException")return h.apply(this,arguments);let ge=!1;if(typeof he!="function"){if(!he.handleEvent)return h.apply(this,arguments);ge=!0}if(ue&&!ue(h,he,K,arguments))return;let Ut=!!ht&&ht.indexOf(J)!==-1,Ct=S(Q(arguments[2],Ut)),cn=Ct?.signal;if(cn?.aborted)return;if(Ot){for(let vt=0;vt<Ot.length;vt++)if(J===Ot[vt])return Ut?h.call(K,J,he,Ct):h.apply(this,arguments)}let Pi=Ct?typeof Ct=="boolean"?!0:Ct.capture:!1,ao=Ct&&typeof Ct=="object"?Ct.once:!1,Ls=Zone.current,Di=mt[J];Di||(qr(J,_e),Di=mt[J]);let co=Di[Pi?Ft:At],ln=K[co],lo=!1;if(ln){if(lo=!0,Te){for(let vt=0;vt<ln.length;vt++)if(Mt(ln[vt],he))return}}else ln=K[co]=[];let Fn,po=K.constructor.name,uo=Wr[po];uo&&(Fn=uo[J]),Fn||(Fn=po+T+(_e?_e(J):J)),Y.options=Ct,ao&&(Y.options.once=!1),Y.target=K,Y.capture=Pi,Y.eventName=J,Y.isExisting=lo;let In=ce?Zs:void 0;In&&(In.taskData=Y),cn&&(Y.options.signal=void 0);let gt=Ls.scheduleEventTask(Fn,he,In,V,G);if(cn){Y.options.signal=cn;let vt=()=>gt.zone.cancelTask(gt);h.call(cn,"abort",vt,{once:!0}),gt.removeAbortListener=()=>cn.removeEventListener("abort",vt)}if(Y.target=null,In&&(In.taskData=null),ao&&(Y.options.once=!0),typeof gt.options!="boolean"&&(gt.options=Ct),gt.target=K,gt.capture=Pi,gt.eventName=J,ge&&(gt.originalDelegate=he),X?ln.unshift(gt):ln.push(gt),N)return K}};return L[o]=w(z,_,xe,re,fe),ye&&(L[y]=w(ye,I,B,re,fe,!0)),L[r]=function(){let h=this||t,T=arguments[0];k&&k.transferEventName&&(T=k.transferEventName(T));let V=arguments[2],G=V?typeof V=="boolean"?!0:V.capture:!1,N=arguments[1];if(!N)return Z.apply(this,arguments);if(ue&&!ue(Z,N,h,arguments))return;let X=mt[T],K;X&&(K=X[G?Ft:At]);let J=K&&h[K];if(J)for(let he=0;he<J.length;he++){let ge=J[he];if(Mt(ge,N)){if(J.splice(he,1),ge.isRemoved=!0,J.length===0&&(ge.allRemoved=!0,h[K]=null,!G&&typeof T=="string")){let Ut=Rn+"ON_PROPERTY"+T;h[Ut]=null}return ge.zone.cancelTask(ge),fe?h:void 0}}return Z.apply(this,arguments)},L[s]=function(){let h=this||t,T=arguments[0];k&&k.transferEventName&&(T=k.transferEventName(T));let V=[],G=zr(h,_e?_e(T):T);for(let N=0;N<G.length;N++){let X=G[N],K=X.originalDelegate?X.originalDelegate:X.callback;V.push(K)}return V},L[m]=function(){let h=this||t,T=arguments[0];if(T){k&&k.transferEventName&&(T=k.transferEventName(T));let V=mt[T];if(V){let G=V[At],N=V[Ft],X=h[G],K=h[N];if(X){let J=X.slice();for(let he=0;he<J.length;he++){let ge=J[he],Ut=ge.originalDelegate?ge.originalDelegate:ge.callback;this[r].call(this,T,Ut,ge.options)}}if(K){let J=K.slice();for(let he=0;he<J.length;he++){let ge=J[he],Ut=ge.originalDelegate?ge.originalDelegate:ge.callback;this[r].call(this,T,Ut,ge.options)}}}}else{let V=Object.keys(h);for(let G=0;G<V.length;G++){let N=V[G],X=Hr.exec(N),K=X&&X[1];K&&K!=="removeListener"&&this[m].call(this,K)}this[m].call(this,"removeListener")}if(fe)return this},jt(L[o],z),jt(L[r],Z),Ve&&jt(L[m],Ve),$&&jt(L[s],$),!0}let ae=[];for(let j=0;j<i.length;j++)ae[j]=U(i[j],n);return ae}function zr(t,e){if(!e){let r=[];for(let s in t){let m=Hr.exec(s),l=m&&m[1];if(l&&(!e||l===e)){let _=t[s];if(_)for(let y=0;y<_.length;y++)r.push(_[y])}}return r}let i=mt[e];i||(qr(e),i=mt[e]);let n=t[i[At]],o=t[i[Ft]];return n?o?n.concat(o):n.slice():o?o.slice():[]}function zs(t,e){let i=t.Event;i&&i.prototype&&e.patchMethod(i.prototype,"stopImmediatePropagation",n=>function(o,r){o[Zr]=!0,n&&n.apply(o,r)})}function Gs(t,e){e.patchMethod(t,"queueMicrotask",i=>function(n,o){Zone.current.scheduleMicroTask("queueMicrotask",o[0])})}var mi=pe("zoneTask");function Tn(t,e,i,n){let o=null,r=null;e+=n,i+=n;let s={};function m(_){let y=_.data;y.args[0]=function(){return _.invoke.apply(this,arguments)};let I=o.apply(t,y.args);return Fr(I)?y.handleId=I:(y.handle=I,y.isRefreshable=Nr(I.refresh)),_}function l(_){let{handle:y,handleId:I}=_.data;return r.call(t,y??I)}o=Bt(t,e,_=>function(y,I){if(Nr(I[0])){let C={isRefreshable:!1,isPeriodic:n==="Interval",delay:n==="Timeout"||n==="Interval"?I[1]||0:void 0,args:I},v=I[0];I[0]=function(){try{return v.apply(this,arguments)}finally{let{handle:ce,handleId:ue,isPeriodic:Te,isRefreshable:fe}=C;!Te&&!fe&&(ue?delete s[ue]:ce&&(ce[mi]=null))}};let O=Gi(e,I[0],C,m,l);if(!O)return O;let{handleId:H,handle:U,isRefreshable:ae,isPeriodic:j}=O.data;if(H)s[H]=O;else if(U&&(U[mi]=O,ae&&!j)){let k=U.refresh;U.refresh=function(){let{zone:ce,state:ue}=O;return ue==="notScheduled"?(O._state="scheduled",ce._updateTaskCount(O,1)):ue==="running"&&(O._state="scheduling"),k.call(this)}}return U??H??O}else return _.apply(t,I)}),r=Bt(t,i,_=>function(y,I){let C=I[0],v;Fr(C)?(v=s[C],delete s[C]):(v=C?.[mi],v?C[mi]=null:v=C),v?.type?v.cancelFn&&v.zone.cancelTask(v):_.apply(t,I)})}function $s(t,e){let{isBrowser:i,isMix:n}=e.getGlobalObjects();if(!i&&!n||!t.customElements||!("customElements"in t))return;let o=["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback","formAssociatedCallback","formDisabledCallback","formResetCallback","formStateRestoreCallback"];e.patchCallbacks(e,t.customElements,"customElements","define",o)}function Ys(t,e){if(Zone[e.symbol("patchEventTarget")])return;let{eventNames:i,zoneSymbolEventNames:n,TRUE_STR:o,FALSE_STR:r,ZONE_SYMBOL_PREFIX:s}=e.getGlobalObjects();for(let l=0;l<i.length;l++){let _=i[l],y=_+r,I=_+o,C=s+y,v=s+I;n[_]={},n[_][r]=C,n[_][o]=v}let m=t.EventTarget;if(!(!m||!m.prototype))return e.patchEventTarget(t,e,[m&&m.prototype]),!0}function Qs(t,e){e.patchEventPrototype(t,e)}function Gr(t,e,i){if(!i||i.length===0)return e;let n=i.filter(r=>r.target===t);if(n.length===0)return e;let o=n[0].ignoreProperties;return e.filter(r=>o.indexOf(r)===-1)}function Ar(t,e,i,n){if(!t)return;let o=Gr(t,e,i);Ur(t,o,n)}function Ui(t){return Object.getOwnPropertyNames(t).filter(e=>e.startsWith("on")&&e.length>2).map(e=>e.substring(2))}function Xs(t,e){if(gi&&!Vr||Zone[t.symbol("patchEvents")])return;let i=e.__Zone_ignore_on_properties,n=[];if(Yi){let o=window;n=n.concat(["Document","SVGElement","Element","HTMLElement","HTMLBodyElement","HTMLMediaElement","HTMLFrameSetElement","HTMLFrameElement","HTMLIFrameElement","HTMLMarqueeElement","Worker"]);let r=[];Ar(o,Ui(o),i&&i.concat(r),Hi(o))}n=n.concat(["XMLHttpRequest","XMLHttpRequestEventTarget","IDBIndex","IDBRequest","IDBOpenDBRequest","IDBDatabase","IDBTransaction","IDBCursor","WebSocket"]);for(let o=0;o<n.length;o++){let r=e[n[o]];r?.prototype&&Ar(r.prototype,Ui(r.prototype),i)}}function Ks(t){t.__load_patch("legacy",e=>{let i=e[t.__symbol__("legacyPatch")];i&&i()}),t.__load_patch("timers",e=>{let n="clear";Tn(e,"set",n,"Timeout"),Tn(e,"set",n,"Interval"),Tn(e,"set",n,"Immediate")}),t.__load_patch("requestAnimationFrame",e=>{Tn(e,"request","cancel","AnimationFrame"),Tn(e,"mozRequest","mozCancel","AnimationFrame"),Tn(e,"webkitRequest","webkitCancel","AnimationFrame")}),t.__load_patch("blocking",(e,i)=>{let n=["alert","prompt","confirm"];for(let o=0;o<n.length;o++){let r=n[o];Bt(e,r,(s,m,l)=>function(_,y){return i.current.run(s,e,y,l)})}}),t.__load_patch("EventTarget",(e,i,n)=>{Qs(e,n),Ys(e,n);let o=e.XMLHttpRequestEventTarget;o&&o.prototype&&n.patchEventTarget(e,n,[o.prototype])}),t.__load_patch("MutationObserver",(e,i,n)=>{Pn("MutationObserver"),Pn("WebKitMutationObserver")}),t.__load_patch("IntersectionObserver",(e,i,n)=>{Pn("IntersectionObserver")}),t.__load_patch("FileReader",(e,i,n)=>{Pn("FileReader")}),t.__load_patch("on_property",(e,i,n)=>{Xs(n,e)}),t.__load_patch("customElements",(e,i,n)=>{$s(e,n)}),t.__load_patch("XHR",(e,i)=>{_(e);let n=pe("xhrTask"),o=pe("xhrSync"),r=pe("xhrListener"),s=pe("xhrScheduled"),m=pe("xhrURL"),l=pe("xhrErrorBeforeScheduled");function _(y){let I=y.XMLHttpRequest;if(!I)return;let C=I.prototype;function v(z){return z[n]}let O=C[Bi],H=C[ji];if(!O){let z=y.XMLHttpRequestEventTarget;if(z){let Z=z.prototype;O=Z[Bi],H=Z[ji]}}let U="readystatechange",ae="scheduled";function j(z){let Z=z.data,$=Z.target;$[s]=!1,$[l]=!1;let Ve=$[r];O||(O=$[Bi],H=$[ji]),Ve&&H.call($,U,Ve);let ye=$[r]=()=>{if($.readyState===$.DONE)if(!Z.aborted&&$[s]&&z.state===ae){let D=$[i.__symbol__("loadfalse")];if($.status!==0&&D&&D.length>0){let u=z.invoke;z.invoke=function(){let f=$[i.__symbol__("loadfalse")];for(let B=0;B<f.length;B++)f[B]===z&&f.splice(B,1);!Z.aborted&&z.state===ae&&u.call(z)},D.push(z)}else z.invoke()}else!Z.aborted&&$[s]===!1&&($[l]=!0)};return O.call($,U,ye),$[n]||($[n]=z),_e.apply($,Z.args),$[s]=!0,z}function k(){}function ce(z){let Z=z.data;return Z.aborted=!0,Y.apply(Z.target,Z.args)}let ue=Bt(C,"open",()=>function(z,Z){return z[o]=Z[2]==!1,z[m]=Z[1],ue.apply(z,Z)}),Te="XMLHttpRequest.send",fe=pe("fetchTaskAborting"),L=pe("fetchTaskScheduling"),_e=Bt(C,"send",()=>function(z,Z){if(i.current[L]===!0||z[o])return _e.apply(z,Z);{let $={target:z,url:z[m],isPeriodic:!1,args:Z,aborted:!1},Ve=Gi(Te,k,$,j,ce);z&&z[l]===!0&&!$.aborted&&Ve.state===ae&&Ve.invoke()}}),Y=Bt(C,"abort",()=>function(z,Z){let $=v(z);if($&&typeof $.type=="string"){if($.cancelFn==null||$.data&&$.data.aborted)return;$.zone.cancelTask($)}else if(i.current[fe]===!0)return Y.apply(z,Z)})}}),t.__load_patch("geolocation",e=>{e.navigator&&e.navigator.geolocation&&Vs(e.navigator.geolocation,["getCurrentPosition","watchPosition"])}),t.__load_patch("PromiseRejectionEvent",(e,i)=>{function n(o){return function(r){zr(e,o).forEach(m=>{let l=e.PromiseRejectionEvent;if(l){let _=new l(o,{promise:r.promise,reason:r.rejection});m.invoke(_)}})}}e.PromiseRejectionEvent&&(i[pe("unhandledPromiseRejectionHandler")]=n("unhandledrejection"),i[pe("rejectionHandledHandler")]=n("rejectionhandled"))}),t.__load_patch("queueMicrotask",(e,i,n)=>{Gs(e,n)})}function Js(t){t.__load_patch("ZoneAwarePromise",(e,i,n)=>{let o=Object.getOwnPropertyDescriptor,r=Object.defineProperty;function s(S){if(S&&S.toString===Object.prototype.toString){let w=S.constructor&&S.constructor.name;return(w||"")+": "+JSON.stringify(S)}return S?S.toString():Object.prototype.toString.call(S)}let m=n.symbol,l=[],_=e[m("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")]!==!1,y=m("Promise"),I=m("then"),C="__creationTrace__";n.onUnhandledError=S=>{if(n.showUncaughtError()){let w=S&&S.rejection;w?console.error("Unhandled Promise rejection:",w instanceof Error?w.message:w,"; Zone:",S.zone.name,"; Task:",S.task&&S.task.source,"; Value:",w,w instanceof Error?w.stack:void 0):console.error(S)}},n.microtaskDrainDone=()=>{for(;l.length;){let S=l.shift();try{S.zone.runGuarded(()=>{throw S.throwOriginal?S.rejection:S})}catch(w){O(w)}}};let v=m("unhandledPromiseRejectionHandler");function O(S){n.onUnhandledError(S);try{let w=i[v];typeof w=="function"&&w.call(this,S)}catch{}}function H(S){return S&&typeof S.then=="function"}function U(S){return S}function ae(S){return re.reject(S)}let j=m("state"),k=m("value"),ce=m("finally"),ue=m("parentPromiseValue"),Te=m("parentPromiseState"),fe="Promise.then",L=null,_e=!0,Y=!1,z=0;function Z(S,w){return h=>{try{Q(S,w,h)}catch(T){Q(S,!1,T)}}}let $=function(){let S=!1;return function(h){return function(){S||(S=!0,h.apply(null,arguments))}}},Ve="Promise resolved with itself",ye=m("currentTaskTrace");function Q(S,w,h){let T=$();if(S===h)throw new TypeError(Ve);if(S[j]===L){let V=null;try{(typeof h=="object"||typeof h=="function")&&(V=h&&h.then)}catch(G){return T(()=>{Q(S,!1,G)})(),S}if(w!==Y&&h instanceof re&&h.hasOwnProperty(j)&&h.hasOwnProperty(k)&&h[j]!==L)u(h),Q(S,h[j],h[k]);else if(w!==Y&&typeof V=="function")try{V.call(h,T(Z(S,w)),T(Z(S,!1)))}catch(G){T(()=>{Q(S,!1,G)})()}else{S[j]=w;let G=S[k];if(S[k]=h,S[ce]===ce&&w===_e&&(S[j]=S[Te],S[k]=S[ue]),w===Y&&h instanceof Error){let N=i.currentTask&&i.currentTask.data&&i.currentTask.data[C];N&&r(h,ye,{configurable:!0,enumerable:!1,writable:!0,value:N})}for(let N=0;N<G.length;)f(S,G[N++],G[N++],G[N++],G[N++]);if(G.length==0&&w==Y){S[j]=z;let N=h;try{throw new Error("Uncaught (in promise): "+s(h)+(h&&h.stack?`
`+h.stack:""))}catch(X){N=X}_&&(N.throwOriginal=!0),N.rejection=h,N.promise=S,N.zone=i.current,N.task=i.currentTask,l.push(N),n.scheduleMicroTask()}}}return S}let D=m("rejectionHandledHandler");function u(S){if(S[j]===z){try{let w=i[D];w&&typeof w=="function"&&w.call(this,{rejection:S[k],promise:S})}catch{}S[j]=Y;for(let w=0;w<l.length;w++)S===l[w].promise&&l.splice(w,1)}}function f(S,w,h,T,V){u(S);let G=S[j],N=G?typeof T=="function"?T:U:typeof V=="function"?V:ae;w.scheduleMicroTask(fe,()=>{try{let X=S[k],K=!!h&&ce===h[ce];K&&(h[ue]=X,h[Te]=G);let J=w.run(N,void 0,K&&N!==ae&&N!==U?[]:[X]);Q(h,!0,J)}catch(X){Q(h,!1,X)}},h)}let B="function ZoneAwarePromise() { [native code] }",q=function(){},xe=e.AggregateError;class re{static toString(){return B}static resolve(w){return w instanceof re?w:Q(new this(null),_e,w)}static reject(w){return Q(new this(null),Y,w)}static withResolvers(){let w={};return w.promise=new re((h,T)=>{w.resolve=h,w.reject=T}),w}static any(w){if(!w||typeof w[Symbol.iterator]!="function")return Promise.reject(new xe([],"All promises were rejected"));let h=[],T=0;try{for(let N of w)T++,h.push(re.resolve(N))}catch{return Promise.reject(new xe([],"All promises were rejected"))}if(T===0)return Promise.reject(new xe([],"All promises were rejected"));let V=!1,G=[];return new re((N,X)=>{for(let K=0;K<h.length;K++)h[K].then(J=>{V||(V=!0,N(J))},J=>{G.push(J),T--,T===0&&(V=!0,X(new xe(G,"All promises were rejected")))})})}static race(w){let h,T,V=new this((X,K)=>{h=X,T=K});function G(X){h(X)}function N(X){T(X)}for(let X of w)H(X)||(X=this.resolve(X)),X.then(G,N);return V}static all(w){return re.allWithCallback(w)}static allSettled(w){return(this&&this.prototype instanceof re?this:re).allWithCallback(w,{thenCallback:T=>({status:"fulfilled",value:T}),errorCallback:T=>({status:"rejected",reason:T})})}static allWithCallback(w,h){let T,V,G=new this((J,he)=>{T=J,V=he}),N=2,X=0,K=[];for(let J of w){H(J)||(J=this.resolve(J));let he=X;try{J.then(ge=>{K[he]=h?h.thenCallback(ge):ge,N--,N===0&&T(K)},ge=>{h?(K[he]=h.errorCallback(ge),N--,N===0&&T(K)):V(ge)})}catch(ge){V(ge)}N++,X++}return N-=2,N===0&&T(K),G}constructor(w){let h=this;if(!(h instanceof re))throw new Error("Must be an instanceof Promise.");h[j]=L,h[k]=[];try{let T=$();w&&w(T(Z(h,_e)),T(Z(h,Y)))}catch(T){Q(h,!1,T)}}get[Symbol.toStringTag](){return"Promise"}get[Symbol.species](){return re}then(w,h){let T=this.constructor?.[Symbol.species];(!T||typeof T!="function")&&(T=this.constructor||re);let V=new T(q),G=i.current;return this[j]==L?this[k].push(G,V,w,h):f(this,G,V,w,h),V}catch(w){return this.then(null,w)}finally(w){let h=this.constructor?.[Symbol.species];(!h||typeof h!="function")&&(h=re);let T=new h(q);T[ce]=ce;let V=i.current;return this[j]==L?this[k].push(V,T,w,w):f(this,V,T,w,w),T}}re.resolve=re.resolve,re.reject=re.reject,re.race=re.race,re.all=re.all;let Vt=e[y]=e.Promise;e.Promise=re;let Mt=m("thenPatched");function Ot(S){let w=S.prototype,h=o(w,"then");if(h&&(h.writable===!1||!h.configurable))return;let T=w.then;w[I]=T,S.prototype.then=function(V,G){return new re((X,K)=>{T.call(this,X,K)}).then(V,G)},S[Mt]=!0}n.patchThen=Ot;function ht(S){return function(w,h){let T=S.apply(w,h);if(T instanceof re)return T;let V=T.constructor;return V[Mt]||Ot(V),T}}return Vt&&(Ot(Vt),Bt(e,"fetch",S=>ht(S))),Promise[i.__symbol__("uncaughtPromiseErrors")]=l,re})}function ea(t){t.__load_patch("toString",e=>{let i=Function.prototype.toString,n=pe("OriginalDelegate"),o=pe("Promise"),r=pe("Error"),s=function(){if(typeof this=="function"){let y=this[n];if(y)return typeof y=="function"?i.call(y):Object.prototype.toString.call(y);if(this===Promise){let I=e[o];if(I)return i.call(I)}if(this===Error){let I=e[r];if(I)return i.call(I)}}return i.call(this)};s[n]=i,Function.prototype.toString=s;let m=Object.prototype.toString,l="[object Promise]";Object.prototype.toString=function(){return typeof Promise=="function"&&this instanceof Promise?l:m.call(this)}})}function ta(t,e,i,n,o){let r=Zone.__symbol__(n);if(e[r])return;let s=e[r]=e[n];e[n]=function(m,l,_){return l&&l.prototype&&o.forEach(function(y){let I=`${i}.${n}::`+y,C=l.prototype;try{if(C.hasOwnProperty(y)){let v=t.ObjectGetOwnPropertyDescriptor(C,y);v&&v.value?(v.value=t.wrapWithCurrentZone(v.value,I),t._redefineProperty(l.prototype,y,v)):C[y]&&(C[y]=t.wrapWithCurrentZone(C[y],I))}else C[y]&&(C[y]=t.wrapWithCurrentZone(C[y],I))}catch{}}),s.call(e,m,l,_)},t.attachOriginToPatched(e[n],s)}function na(t){t.__load_patch("util",(e,i,n)=>{let o=Ui(e);n.patchOnProperties=Ur,n.patchMethod=Bt,n.bindArguments=$i,n.patchMacroTask=Ws;let r=i.__symbol__("BLACK_LISTED_EVENTS"),s=i.__symbol__("UNPATCHED_EVENTS");e[s]&&(e[r]=e[s]),e[r]&&(i[r]=i[s]=e[r]),n.patchEventPrototype=zs,n.patchEventTarget=qs,n.isIEOrEdge=Hs,n.ObjectDefineProperty=Wi,n.ObjectGetOwnPropertyDescriptor=Dn,n.ObjectCreate=As,n.ArraySlice=Bs,n.patchClass=Pn,n.wrapWithCurrentZone=zi,n.filterProperties=Gr,n.attachOriginToPatched=jt,n._redefineProperty=Object.defineProperty,n.patchCallbacks=ta,n.getGlobalObjects=()=>({globalSources:Wr,zoneSymbolEventNames:mt,eventNames:o,isBrowser:Yi,isMix:Vr,isNode:gi,TRUE_STR:Ft,FALSE_STR:At,ZONE_SYMBOL_PREFIX:Rn,ADD_EVENT_LISTENER_STR:Zi,REMOVE_EVENT_LISTENER_STR:qi})})}function ia(t){Js(t),ea(t),na(t)}var $r=Fs();ia($r);Ks($r);function oa(t){t.__load_patch("cordova",(e,i,n)=>{if(e.cordova){let o="cordova.exec.success",r="cordova.exec.error",s="function",m=n.patchMethod(e.cordova,"exec",()=>function(l,_){return _.length>0&&typeof _[0]===s&&(_[0]=i.current.wrap(_[0],o)),_.length>1&&typeof _[1]===s&&(_[1]=i.current.wrap(_[1],r)),m.apply(l,_)})}}),t.__load_patch("cordova.FileReader",(e,i)=>{e.cordova&&typeof e.FileReader<"u"&&document.addEventListener("deviceReady",()=>{let n=e.FileReader;["abort","error","load","loadstart","loadend","progress"].forEach(o=>{let r=i.__symbol__("ON_PROPERTY"+o);Object.defineProperty(n.prototype,r,{configurable:!0,get:function(){return this._realReader&&this._realReader[r]}})})})})}oa(Zone);var Qi="Service workers are disabled or not supported by this browser",Sn=class{serviceWorker;worker;registration;events;constructor(e,i){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=new tt(n=>n.error(new tn(5601,!1)));else{let n=null,o=new Ze;this.worker=new tt(_=>(n!==null&&_.next(n),o.subscribe(y=>_.next(y))));let r=()=>{let{controller:_}=e;_!==null&&(n=_,o.next(n))};e.addEventListener("controllerchange",r),r(),this.registration=this.worker.pipe(De(()=>e.getRegistration().then(_=>{if(!_)throw new tn(5601,!1);return _})));let s=new Ze;this.events=s.asObservable();let m=_=>{let{data:y}=_;y?.type&&s.next(y)};e.addEventListener("message",m),i?.get(Ri,null,{optional:!0})?.onDestroy(()=>{e.removeEventListener("controllerchange",r),e.removeEventListener("message",m)})}}postMessage(e,i){return new Promise(n=>{this.worker.pipe(Ce(1)).subscribe(o=>{o.postMessage(Kt({action:e},i)),n()})})}postMessageWithOperation(e,i,n){let o=this.waitForOperationCompleted(n),r=this.postMessage(e,i);return Promise.all([r,o]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let i;return typeof e=="string"?i=n=>n.type===e:i=n=>e.includes(n.type),this.events.pipe(se(i))}nextEventOfType(e){return this.eventsOfType(e).pipe(Ce(1))}waitForOperationCompleted(e){return new Promise((i,n)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(se(o=>o.nonce===e),Ce(1),F(o=>{if(o.result!==void 0)return o.result;throw new Error(o.error)})).subscribe({next:i,error:n})})}get isEnabled(){return!!this.serviceWorker}},Qr=(()=>{class t{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new Ze;constructor(i){if(this.sw=i,!i.isEnabled){this.messages=Wt,this.notificationClicks=Wt,this.notificationCloses=Wt,this.pushSubscriptionChanges=Wt,this.subscription=Wt;return}this.messages=this.sw.eventsOfType("PUSH").pipe(F(o=>o.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(F(o=>o.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(F(o=>o.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(F(o=>o.data)),this.pushManager=this.sw.registration.pipe(F(o=>o.pushManager));let n=this.pushManager.pipe(De(o=>o.getSubscription()));this.subscription=new tt(o=>{let r=n.subscribe(o),s=this.subscriptionChanges.subscribe(o);return()=>{r.unsubscribe(),s.unsubscribe()}})}requestSubscription(i){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(Qi));let n={userVisibleOnly:!0},o=this.decodeBase64(i.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),r=new Uint8Array(new ArrayBuffer(o.length));for(let s=0;s<o.length;s++)r[s]=o.charCodeAt(s);return n.applicationServerKey=r,new Promise((s,m)=>{this.pushManager.pipe(De(l=>l.subscribe(n)),Ce(1)).subscribe({next:l=>{this.subscriptionChanges.next(l),s(l)},error:m})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(Qi));let i=n=>{if(n===null)throw new tn(5602,!1);return n.unsubscribe().then(o=>{if(!o)throw new tn(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((n,o)=>{this.subscription.pipe(Ce(1),De(i)).subscribe({next:n,error:o})})}decodeBase64(i){return atob(i)}static \u0275fac=function(n){return new(n||t)(Re(Sn))};static \u0275prov=Se({token:t,factory:t.\u0275fac})}return t})(),_i=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(i){if(this.sw=i,!i.isEnabled){this.versionUpdates=Wt,this.unrecoverable=Wt;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Qi));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let i=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:i},i).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new tn(5601,!1));let i=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:i},i)}static \u0275fac=function(n){return new(n||t)(Re(Sn))};static \u0275prov=Se({token:t,factory:t.\u0275fac})}return t})();var Xr=new Zn("");function ra(){let t=Dt(rn);if(!("serviceWorker"in navigator&&t.enabled!==!1))return;let e=Dt(Xr),i=Dt(Po),n=Dt(Ri);i.runOutsideAngular(()=>{let o=navigator.serviceWorker,r=()=>o.controller?.postMessage({action:"INITIALIZE"});o.addEventListener("controllerchange",r),n.onDestroy(()=>{o.removeEventListener("controllerchange",r)})}),i.runOutsideAngular(()=>{let o,{registrationStrategy:r}=t;if(typeof r=="function")o=new Promise(s=>r().subscribe(()=>s()));else{let[s,...m]=(r||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":o=Promise.resolve();break;case"registerWithDelay":o=Yr(+m[0]||0);break;case"registerWhenStable":o=Promise.race([n.whenStable(),Yr(+m[0])]);break;default:throw new tn(5600,!1)}}o.then(()=>{n.destroyed||navigator.serviceWorker.register(e,{scope:t.scope,updateViaCache:t.updateViaCache,type:t.type}).catch(s=>console.error(Eo(5604,!1)))})})}function Yr(t){return new Promise(e=>setTimeout(e,t))}function sa(t,e){return new Sn(t.enabled!==!1?navigator.serviceWorker:void 0,e)}var rn=class{enabled;updateViaCache;type;scope;registrationStrategy};function aa(t,e={}){return ko([Qr,_i,{provide:Xr,useValue:t},{provide:rn,useValue:e},{provide:Sn,useFactory:sa,deps:[rn,Mo]},Ro(ra)])}var Kr=(()=>{class t{static register(i,n={}){return{ngModule:t,providers:[aa(i,n)]}}static \u0275fac=function(n){return new(n||t)};static \u0275mod=ke({type:t});static \u0275inj=Ee({providers:[Qr,_i]})}return t})();var bi=(function(t){An(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.scan=function(i,n){return ee(this,"scan",{observable:!0},arguments)},e.prototype.startScan=function(i){return ee(this,"startScan",{observable:!0,clearFunction:"stopScan",clearWithArgs:!1},arguments)},e.prototype.startScanWithOptions=function(i,n){return ee(this,"startScanWithOptions",{observable:!0,clearFunction:"stopScan",clearWithArgs:!1},arguments)},e.prototype.stopScan=function(){return ee(this,"stopScan",{},arguments)},e.prototype.setPin=function(i){return ee(this,"setPin",{observable:!0},arguments)},e.prototype.connect=function(i){return ee(this,"connect",{observable:!0,clearFunction:"disconnect",clearWithArgs:!0},arguments)},e.prototype.autoConnect=function(i,n,o){return ee(this,"autoConnect",{sync:!0},arguments)},e.prototype.requestMtu=function(i,n){return ee(this,"requestMtu",{},arguments)},e.prototype.requestConnectionPriority=function(i,n){return ee(this,"requestConnectionPriority",{},arguments)},e.prototype.refreshDeviceCache=function(i,n){return ee(this,"refreshDeviceCache",{},arguments)},e.prototype.disconnect=function(i){return ee(this,"disconnect",{},arguments)},e.prototype.read=function(i,n,o){return ee(this,"read",{},arguments)},e.prototype.write=function(i,n,o,r){return ee(this,"write",{},arguments)},e.prototype.writeWithoutResponse=function(i,n,o,r){return ee(this,"writeWithoutResponse",{},arguments)},e.prototype.startNotification=function(i,n,o){return ee(this,"startNotification",{observable:!0,destruct:!0,clearFunction:"stopNotification",clearWithArgs:!0},arguments)},e.prototype.stopNotification=function(i,n,o){return ee(this,"stopNotification",{},arguments)},e.prototype.isConnected=function(i){return ee(this,"isConnected",{},arguments)},e.prototype.isEnabled=function(){return ee(this,"isEnabled",{},arguments)},e.prototype.startStateNotifications=function(){return ee(this,"startStateNotifications",{observable:!0,clearFunction:"stopStateNotifications",clearWithArgs:!1},arguments)},e.prototype.stopStateNotifications=function(){return ee(this,"stopStateNotifications",{},arguments)},e.prototype.startLocationStateNotifications=function(){return ee(this,"startLocationStateNotifications",{observable:!0,clearFunction:"stopLocationStateNotifications",clearWithArgs:!1},arguments)},e.prototype.stopLocationStateNotifications=function(){return ee(this,"stopLocationStateNotifications",{},arguments)},e.prototype.showBluetoothSettings=function(){return ee(this,"showBluetoothSettings",{},arguments)},e.prototype.enable=function(){return ee(this,"enable",{},arguments)},e.prototype.readRSSI=function(i){return ee(this,"readRSSI",{},arguments)},e.prototype.connectedPeripheralsWithServices=function(i){return ee(this,"connectedPeripheralsWithServices",{},arguments)},e.prototype.peripheralsWithIdentifiers=function(i){return ee(this,"peripheralsWithIdentifiers",{},arguments)},e.prototype.bondedDevices=function(){return ee(this,"bondedDevices",{},arguments)},e.prototype.isLocationEnabled=function(){return ee(this,"isLocationEnabled",{},arguments)},e.\u0275fac=(()=>{let i;return function(o){return(i||(i=zn(e)))(o||e)}})(),e.\u0275prov=Se({token:e,factory:e.\u0275fac}),e.pluginName="BLE",e.plugin="cordova-plugin-ble-central",e.pluginRef="ble",e.repo="https://github.com/don/cordova-plugin-ble-central",e.platforms=["Android","iOS"],e=Bn([],e),e})(ci);var Ci=(function(t){An(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.requestPermission=function(i){return ee(this,"requestPermission",{successIndex:1,errorIndex:2},arguments)},e.prototype.open=function(i){return ee(this,"open",{},arguments)},e.prototype.write=function(i){return ee(this,"write",{},arguments)},e.prototype.writeHex=function(i){return ee(this,"writeHex",{},arguments)},e.prototype.read=function(){return ee(this,"read",{},arguments)},e.prototype.registerReadCallback=function(){return ee(this,"registerReadCallback",{observable:!0},arguments)},e.prototype.close=function(){return ee(this,"close",{},arguments)},e.\u0275fac=(()=>{let i;return function(o){return(i||(i=zn(e)))(o||e)}})(),e.\u0275prov=Se({token:e,factory:e.\u0275fac}),e.pluginName="Serial",e.plugin="cordovarduino",e.pluginRef="serial",e.repo="https://github.com/xseignard/cordovarduino",e.platforms=["Android"],e=Bn([],e),e})(ci);var Xi=new Zn("TRANSLATE_HTTP_LOADER_CONFIG"),ua=(()=>{class t{http;config;constructor(){this.config=Kt({prefix:"/assets/i18n/",suffix:".json",enforceLoading:!1,useHttpBackend:!1},Dt(Xi)),this.http=this.config.useHttpBackend?new Qn(Dt(Fi)):Dt(Qn)}getTranslation(i){let n=this.config.enforceLoading?`?enforceLoading=${Date.now()}`:"";return this.http.get(`${this.config.prefix}${i}${this.config.suffix}${n}`)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Se({token:t,factory:t.\u0275fac})}return t})();function Jr(t={}){let e=t.useHttpBackend??!1;return[{provide:Xi,useValue:t},{provide:Ir,useClass:ua,deps:[e?Fi:Qn,Xi]}]}var Oe=class{};var Le=class t{get buffer(){return this.array.buffer}get byteLength(){return this.array.byteLength}get byteOffset(){return this.array.byteOffset}constructor(e,i,n){n!==void 0?this.array=new Uint8Array(e,i,n):i?this.array=new Uint8Array(e,i):this.array=new Uint8Array(e)}getUint4(e){return this.array[e]&15}getUint8(e){return this.array[e]&15|(this.array[e+1]&15)<<4}getUint32(e){let i=0;return i|=(this.array[e+0]&15)<<24,i|=(this.array[e+1]&15)<<28,i|=(this.array[e+2]&15)<<16,i|=(this.array[e+3]&15)<<20,i|=(this.array[e+4]&15)<<8,i|=(this.array[e+5]&15)<<12,i|=(this.array[e+6]&15)<<0,i|=(this.array[e+7]&15)<<4,i}getUint8Array(e,i){let n=new Uint8Array(i);for(let o=0;o!=i;++o)n[o]=this.array[e+o]&15;return n}setUint4(e,i){this.array[e]=i|48}setUint8(e,i){this.array[e]=i&15|48,this.array[e+1]=i>>4|48}toString(e,i){return String.fromCharCode.apply(null,[...this.subarray(e,i)])}static from(e,...i){let n=new Uint8Array(i.length+2),o=n[0]=e.charCodeAt(0);for(let r=0;r!=i.length;++r){let s=i[r];n[r+1]=48|s,o+=s}return n[n.length-1]=48|o&15,new t(n.buffer)}static fromString(e){let i=new Uint8Array(e.split("").map(n=>n.charCodeAt(0)));return new t(i.buffer)}subarray(e,i){return i!==void 0?this.array.subarray(e,e+i):e?this.array.subarray(e):this.array}};var es=Le.fromString("?"),da=Le.fromString("=10"),ma=Le.fromString("0"),sn=(function(t){return t[t.ESC=1]="ESC",t[t.PACE_CAR=1]="PACE_CAR",t[t.ENTER=2]="ENTER",t[t.START=2]="START",t[t.SPEED=5]="SPEED",t[t.BRAKE=6]="BRAKE",t[t.FUEL=7]="FUEL",t[t.CODE=8]="CODE",t})(sn||{});var vi=class{constructor(e,i){this.peripheral=e,this.settings=i,this.requests=new Array,this.state=new Mn("disconnected"),this.version=null,this.connection=this.peripheral.connect({next:()=>this.connection.next(es.buffer)});let n=this.connection.pipe(jn({first:i.connectionTimeout,each:i.requestTimeout}),F((o,r)=>(r==0&&this.state.next("connected"),o)));this.data=n.pipe(wo(o=>this.doReconnect(o)),Ue(()=>{this.poll()}),F(o=>new Le(o)),xo()),this.status=this.data.pipe(se(o=>o.byteLength>=16&&o.toString(0,2)==="?:"),en(1),Jt())}connect(){return this.state.next("connecting"),this.subscription=this.data.connect(),Promise.resolve()}disconnect(){return this.subscription&&this.subscription.unsubscribe(),Promise.resolve()}reconnect(){return new Promise(e=>{this.disconnect(),setTimeout(()=>{this.connect(),e()},this.settings.minReconnectDelay)})}getState(){return this.state.asObservable().pipe(Pe(),To())}getFuel(){return this.status.pipe(F(e=>e.getUint8Array(2,8)))}getStart(){return this.status.pipe(F(e=>e.getUint4(10)))}getMode(){return this.status.pipe(F(e=>e.getUint4(11)))}getPit(){return this.status.pipe(F(e=>e.getUint8(12)))}getTimer(){return this.data.pipe(se(e=>e.byteLength>=12&&e.toString(0,1)==="?"&&e.toString(1,1)!==":"),se(e=>{let i=e.toString(1,1);return i>="1"&&i<="8"}),F(e=>[e.getUint4(1)-1,e.getUint32(2),e.getUint4(10)]),Pe((e,i)=>e[0]===i[0]&&e[1]===i[1]))}getVersion(){return this.version||(this.version=this.data.pipe(se(e=>e.byteLength==6&&e.toString(0,1)=="0"),F(e=>e.toString(1,4)),Ce(1)).toPromise(),this.requests.push(ma)),this.version}reset(){this.requests.push(da)}setLap(e){this.setLapHi(e>>4),this.setLapLo(e&15)}setLapHi(e){this.set(17,7,e)}setLapLo(e){this.set(18,7,e)}setPosition(e,i){this.set(6,e,i)}clearPosition(){this.set(6,0,9)}setMask(e){this.requests.push(Le.from(":",e&15,e>>4))}setSpeed(e,i){this.set(0,e,i,2)}setBrake(e,i){this.set(1,e,i,2)}setFuel(e,i){this.set(2,e,i,2)}setFinished(e){this.set(7,e,1)}toggleStart(){this.trigger(sn.START)}trigger(e){this.requests.push(Le.fromString("T"+String.fromCharCode(48|e)))}set(e,i,n,o=1){let r=[e&15,e>>4|i<<1,n,o];this.requests.push(Le.from("J",...r))}poll(){let e=this.requests.shift()||es;this.connection.next(e.buffer)}doReconnect(e){let i=this.state;return e.pipe(_t((n,o)=>i.value==="connected"?0:n+1,0),Ue(()=>i.next("disconnected")),go(n=>{let o=this.settings.minReconnectDelay*Math.pow(1.5,n);return ho(Math.min(o,this.settings.maxReconnectDelay))}),Ue(()=>i.next("connecting")))}};var ts="39df7777-b1b4-b90b-57f1-7144ae4e4a6a",fa="39df8888-b1b4-b90b-57f1-7144ae4e4a6a",ha="39df9999-b1b4-b90b-57f1-7144ae4e4a6a",ga=36;function ns(t){return new Le(t).toString()}var Ki=class{constructor(e,i,n){this.ble=i,this.logger=n,this.type="ble",this.name=e.name,this.address=e.id}connect(e,i){let n=this.createObservable(e,i),o=this.createObserver(i);return Ze.create(o,n)}equals(e){return e&&e.type===this.type&&e.address===this.address}createObservable(e,i){return new tt(n=>{this.logger.info("Connecting to BLE device "+this.address);let o=!1,r=null;return this.lastWritten=null,this.ble.connect(this.address).subscribe({next:s=>{this.logger.info("Connected to BLE device",s),o=!0,this.ble.startNotification(this.address,ts,ha).subscribe({next:([m,l])=>{if(this.logger.isDebugEnabled()){let _=ns(m);_!==r&&(this.logger.debug("BLE received "+_),r=_)}this.onNotify(m,n)},error:m=>this.onError(m,n)}),e&&this.ble.isConnected(this.address).then(()=>{this.logger.info("BLE device ready"),o&&e.next(void 0)}).catch(m=>{this.logger.error("BLE device not connected",m)})},error:s=>{s instanceof Error?(this.logger.error("BLE connection error",s),n.error(s)):o?(this.logger.info("BLE device disconnected",s),n.complete()):(this.logger.error("BLE connection error",s),n.error(new Error("Connection error"))),o=!1},complete:()=>{this.logger.info("BLE connection closed"),n.complete(),o=!1}}),()=>{this.disconnect(i)}})}createObserver(e){return{next:i=>{if(this.logger.isDebugEnabled()){let n=ns(i);n!==this.lastWritten&&(this.logger.debug("BLE write "+n),this.lastWritten=n)}this.write(i)},error:i=>this.logger.error("BLE user error",i),complete:()=>this.disconnect(e)}}write(e){this.ble.writeWithoutResponse(this.address,ts,fa,e).catch(i=>{this.logger.error("BLE write error",i)})}disconnect(e){this.logger.debug("Closing BLE connection to "+this.address),this.ble.disconnect(this.address).then(()=>{this.logger.info("BLE disconnected from "+this.address)}).catch(i=>{this.logger.error("BLE disconnect error",i)}).then(()=>{e&&e.next(void 0)})}onNotify(e,i){let n=new Uint8Array(e);n[n.length-1]==ga&&(n.copyWithin(1,0),n[0]=n.length==6?48:63),i.next(n.buffer)}onError(e,i){i.error(e)}},is=(()=>{let e=class e extends Oe{constructor(n,o,r){super(),this.ble=n,this.logger=o,this.platform=r,this.devices=new Map,this.scanner=Ne(this.platform.ready()).pipe(De(s=>s=="cordova"?Vn(1e3).pipe(nt(null),De(()=>Ne(this.ble.isEnabled().then(()=>!0,()=>!1)))):Je(!1)),Pe(),De(s=>s?(this.logger.info("Start scanning for BLE devices"),this.ble.startScanWithOptions([],{reportDuplicates:!0,scanMode:"lowLatency"}).pipe(Co(()=>this.logger.info("Stop scanning for BLE devices")))):(this.logger.info("Not scanning for BLE devices"),Pt())))}scan(){return this.scanner.pipe(nt(...this.devices.values()),bo(n=>n.id),Ue(n=>this.logger.debug("Discovered BLE device:",n)),se(n=>/Control.Unit/i.test(n.name||"")),Ue(n=>this.logger.info("Discovered Control Unit device:",n)),Ue(n=>this.devices.set(n.id,n)),Ue(n=>this.logger.debug("Cached devices:",Array.from(this.devices.values()))),F(n=>new Ki(n,this.ble,this.logger)))}};e.\u0275fac=function(o){return new(o||e)(Re(bi),Re(be),Re(Tt))},e.\u0275prov=Se({token:e,factory:e.\u0275fac});let t=e;return t})();var _a="5336",ba=1e-4,Ca=1e-4;function En(t,e){return t+Math.random()*(e-t)}function Nn(t){let e=new Uint8Array(t);return String.fromCharCode.apply(null,[...e])}var kt=class{constructor(e){this.sector=0,this.pit=!1,this.events=new Gn,this.id=e,this.fuel=this.id=="7"||this.id=="8"?0:255}start(e,i,n=1,o=0){this.maxSectorTime=i,this.id=="8"?this.minSectorTime=e+(i-e)*.8:this.id=="7"?this.minSectorTime=e+(i-e)*.5:this.minSectorTime=e,this.timeout=setTimeout(()=>this.onNext(),o),this.sectors=n}stop(){clearTimeout(this.timeout)}onRefuel(){this.fuel+=16,this.fuel>=En(192,240)?this.timeout=setTimeout(()=>this.onNext(),this.fuelTime()):this.timeout=setTimeout(()=>this.onRefuel(),500)}onNext(){++this.sector>this.sectors&&(this.sector=1),this.id=="7"||this.id=="8"?(this.events.emit(this),this.timeout=setTimeout(()=>this.onNext(),En(this.minSectorTime,this.maxSectorTime))):((this.fuel>=16||this.sector!==1)&&this.events.emit(this),this.fuel<En(16,48)&&this.sector===1?(this.pit=!0,this.timeout=setTimeout(()=>this.onRefuel(),1500)):this.timeout=setTimeout(()=>this.onFuel(),this.fuelTime()))}onFuel(){this.pit=!1,this.fuel=Math.max(0,this.fuel-En(4,16)),this.timeout=setTimeout(()=>this.onNext(),this.fuelTime())}fuelTime(){return En(this.minSectorTime,this.maxSectorTime)/2}},Ji=class{constructor(e,i,n){this.name=e,this.mode=i,this.logger=n,this.start=Date.now(),this.startSequence=0,this.cars=[new kt("1"),new kt("2"),new kt("3"),new kt("4"),new kt("5"),new kt("6"),new kt("7"),new kt("8")],this.laps=[],this.config={numCars:8,numSectors:3,maxStartTime:1500,minSectorTime:3e3,maxSectorTime:4e3},this.type="demo",this.version=Le.from("0",..._a.split("").map(o=>o.charCodeAt(0))).buffer;for(let o=0;o!=this.config.numCars;++o)this.cars[o].events.subscribe(r=>this.laps.push(this.createLap(r.id,r.sector)));this.startAll()}connect(e,i){return Ze.create(this.createObserver(),this.createObservable(e,i))}equals(e){return e&&e.type===this.type&&e.name==this.name}createObservable(e,i){return new tt(n=>(this.logger.info("Creating Demo observable with mode="+this.mode),this.subscriber=n,setTimeout(()=>{e&&e.next(void 0)},100),()=>{this.logger.info("Destroying Demo observable"),i&&i.next(void 0),delete this.subscriber}))}createObserver(){return{next:e=>{if(Math.random()<Ca){this.subscriber&&(console.log("Random Demo error"),this.subscriber.error(new Error("Demo Error")));return}if(Nn(e)!="?"&&console.log("Demo CU received "+Nn(e)),Nn(e)=="T1"&&this.onESC(),Nn(e)=="T2"&&this.onStart(),Math.random()<ba){console.log("Random Demo timeout");return}setTimeout(()=>{this.subscriber&&(Nn(e)=="0"?this.subscriber.next(this.version):this.subscriber.next(this.laps.length?this.laps.shift():this.createStatus()))},100)},error:e=>{console.log("Demo connection error:",e)},complete:()=>{console.log("Demo connection complete"),this.subscriber.complete()}}}createLap(e,i=1){let n=Date.now()-this.start;return Le.from("?",parseInt(e),n>>24&15,n>>28&15,n>>16&15,n>>20&15,n>>8&15,n>>12&15,n>>0&15,n>>4&15,i).buffer}createStatus(){return Le.from("?",10,this.cars[0].fuel>>4&15,this.cars[1].fuel>>4&15,this.cars[2].fuel>>4&15,this.cars[3].fuel>>4&15,this.cars[4].fuel>>4&15,this.cars[5].fuel>>4&15,this.cars[6].fuel>>4&15,this.cars[7].fuel>>4&15,this.startSequence,this.mode,this.getPitMask(0,4),this.getPitMask(4,8),8).buffer}getPitMask(e,i){let n=0;for(let o=e;o!=i;++o)n>>=1,n|=this.cars[o].pit?8:0;return n}onStart(){this.startSequence==0?(this.stopAll(),this.startSequence=1):this.startSequence==7?(this.startAll(),this.startSequence=0):(this.startSequence++,setTimeout(()=>this.onStart(),1e3))}onESC(){this.startSequence==1&&(this.startAll(),this.startSequence=0)}startAll(){for(let e=0;e!=this.config.numCars;++e)this.cars[e].start(this.config.minSectorTime,this.config.maxSectorTime,this.config.numSectors,En(0,this.config.maxStartTime))}stopAll(){for(let e=0;e!=this.config.numCars;++e)this.cars[e].stop()}},os=(()=>{let e=class e extends Oe{constructor(n){super(),this.logger=n}scan(){return Je(new Ji("Demo Control Unit",6,this.logger))}};e.\u0275fac=function(o){return new(o||e)(Re(be))},e.\u0275prov=Se({token:e,factory:e.\u0275fac});let t=e;return t})();var va=19200,ya=36;function xa(t,e){if(t.length==0)return e;if(e.length==0)return t;{let i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.byteLength),i}}var eo=class{constructor(e,i){this.serial=e,this.logger=i,this.type="serial",this.name="Serial USB OTG",this.connected=!1}connect(e,i){let n=this.createObservable(e,i),o=this.createObserver(i);return Ze.create(o,n)}equals(e){return e&&e.type===this.type}createObservable(e,i){return new tt(n=>(this.logger.info("Connecting to serial port"),this.open({baudRate:va,sleepOnPause:!1}).then(()=>{this.connected=!0,this.logger.info("Connected to serial port");let o=new Uint8Array(0);this.serial.registerReadCallback().subscribe({next:r=>{o=xa(o,new Uint8Array(r));let s=-1;for(;(s=o.indexOf(ya))!=-1;){let m=new Uint8Array(o.subarray(0,s));if(o=o.subarray(s+1),this.logger.isDebugEnabled()){let l=String.fromCharCode.apply(null,[...m]);l!==this.lastReceived&&(this.logger.debug("Serial received "+l),this.lastReceived=l)}n.next(m.buffer)}},error:r=>{this.logger.error("Error reading from serial port",r),n.error(r)}}),e&&e.next(void 0)}).catch(o=>{this.logger.error("Error connecting to serial port",o),n.error(o)}),()=>{this.close(i)}))}createObserver(e){return{next:i=>this.write(i),error:i=>this.logger.error("Serial user error",i),complete:()=>this.close(e)}}open(e){return this.serial.open(e)}write(e){let i=String.fromCharCode.apply(null,[...new Uint8Array(e)]);this.logger.isDebugEnabled()&&i!==this.lastWritten&&(this.logger.debug("Serial write "+i),this.lastWritten=i),this.serial.write('"'+i+"$").catch(n=>{this.logger.error("Serial write error",n)})}close(e){this.connected&&(this.logger.info("Closing serial port"),this.serial.close().then(()=>{this.logger.info("Serial port closed")}).catch(i=>{this.logger.error("Error closing serial port",i)}).then(()=>{e&&e.next(void 0)}),this.connected=!1)}},rs=(()=>{let e=class e extends Oe{constructor(n,o,r){super(),this.serial=o,this.logger=r,this.scanner=Ne(n.getDeviceInfo()).pipe(De(s=>n.isAndroid()&&n.isCordova()&&!s.isVirtual&&parseInt(s.version)<12?Ne(this.serial.requestPermission().then(()=>!0,()=>!1)):Je(!1)),Ue(s=>this.logger.info("Serial device "+(s?"":"not")+" enabled")),mn())}scan(){return this.scanner.pipe(De(n=>n?Je(new eo(this.serial,this.logger)):Pt()))}};e.\u0275fac=function(o){return new(o||e)(Re(pt),Re(Ci),Re(be))},e.\u0275prov=Se({token:e,factory:e.\u0275fac});let t=e;return t})();var as="39df7777-b1b4-b90b-57f1-7144ae4e4a6a",wa="39df8888-b1b4-b90b-57f1-7144ae4e4a6a",Ta="39df9999-b1b4-b90b-57f1-7144ae4e4a6a",Sa=36;function ss(t){return new Le(t).toString()}var to=class{constructor(e,i){this.device=e,this.logger=i,this.type="web-bluetooth",this.name=e.name}connect(e,i){let n=this.createObservable(e,i),o=this.createObserver(i);return Ze.create(o,n)}equals(e){return e&&e.type===this.type}createObservable(e,i){return new tt(n=>{this.logger.info("Connecting to Web Bluetooth device "+this.device.id);let o=this.device.gatt.connect().then(l=>l.getPrimaryService(as)),r=o.then(l=>l.getCharacteristic(Ta)),s=l=>{let _=l.target.value.buffer;if(this.logger.isDebugEnabled()){let y=ss(_);y!==m&&(this.logger.debug("Web Bluetooth received "+y),m=y)}this.onNotify(_,n)},m=null;return this.lastWritten=null,this.output=o.then(l=>l.getCharacteristic(wa)),r.then(l=>l.startNotifications().then(_=>l)).then(l=>{l.addEventListener("characteristicvaluechanged",s),this.logger.info("Web Bluetooth device ready"),e&&e.next(void 0)}).catch(l=>{this.onError(l,n)}),()=>{r.then(l=>l.stopNotifications().then(_=>l)).then(l=>{l.removeEventListener("characteristicvaluechanged",s)}).catch(l=>{this.logger.error("Error stopping Web Bluetooth notifications",l)}).then(l=>{this.disconnect(i)})}})}createObserver(e){return{next:i=>{if(this.device.gatt.connected&&this.output){if(this.logger.isDebugEnabled()){let n=ss(i);n!==this.lastWritten&&(this.logger.debug("Web Bluetooth write "+n),this.lastWritten=n)}this.output.then(n=>n.writeValue(i)).catch(n=>{this.logger.error("Web Bluetooth write error",n)})}else this.logger.error("Web Bluetooth write while device disconnected")},error:i=>this.logger.error("Web Bluetooth user error",i),complete:()=>this.disconnect(e)}}disconnect(e){if(this.device.gatt.connected){this.logger.debug("Closing Web Bluetooth connection to "+this.device.id);try{this.device.gatt.disconnect()}catch(i){this.logger.debug("Error closing Web Bluetooth connection",i)}this.output=null,e&&e.next(void 0)}}onNotify(e,i){let n=new Uint8Array(e);n[n.length-1]==Sa&&(n.copyWithin(1,0),n[0]=n.length==6?48:63),i.next(n.buffer)}onError(e,i){i.error(e)}},cs=(()=>{let e=class e extends Oe{constructor(n,o){super(),this.logger=n,this.platform=o,this.navigator=window.navigator}scan(){return Ne(this.platform.ready()).pipe(De(n=>n!="cordova"&&this.navigator.bluetooth?Ne(this.requestDevice()).pipe(Wn(o=>(this.logger.error("Error requesting Web Bluetooth device:",o),Pt()))):Pt()))}requestDevice(){return this.device?this.device:this.navigator.bluetooth.requestDevice({filters:[{name:"Control_Unit"}],optionalServices:[as]}).then(n=>{let o=new to(n,this.logger);return this.device=Promise.resolve(o),o})}};e.\u0275fac=function(o){return new(o||e)(Re(be),Re(Tt))},e.\u0275prov=Se({token:e,factory:e.\u0275fac});let t=e;return t})();var ls=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Ee({providers:[{provide:Oe,useClass:is,multi:!0},{provide:Oe,useClass:os,multi:!0},{provide:Oe,useClass:rs,multi:!0},{provide:Oe,useClass:cs,multi:!0}]});let t=e;return t})();var Ea=t=>({number:t});function ka(t,e){if(t&1){let i=de();c(0,"ion-col")(1,"ion-button",7),A("click",function(){let o=te(i).$implicit,r=b(2);return ne(r.setColor(o))}),d()()}if(t&2){let i=e.$implicit;a(),Lo("--background",i)}}function Ia(t,e){if(t&1&&(c(0,"ion-row"),P(1,ka,2,2,"ion-col",5),d()),t&2){let i=e.$implicit;a(),p("ngForOf",i)}}var ps=(()=>{let e=class e{constructor(n,o){this.mc=o,this.placeholder="Driver {{number}}",this.colors=[["#ff0000","#00ff00","#0000ff","#ffff00","#ff00ff","#00ffff","#c0c0c0","#ffffff"],["#c02040","#408080","#4080c0","#ff8020","#ff8080","#20ffc0","#404040","#000000"]],this.driver=n.get("driver"),this.id=n.get("id"),this.color=this.driver.color}update(n,o){console.log("update",n,o);let r=("0"+o.detail.value.toString(16)).slice(-2);switch(n){case"r":this.color=this.color.substring(0,1)+r+this.color.substring(3);break;case"g":this.color=this.color.substring(0,3)+r+this.color.substring(5);break;case"b":this.color=this.color.substring(0,5)+r+this.color.substring(7);break}console.log(this.color)}setColor(n){this.color=n}get r(){return this.color?Number.parseInt(this.color.substring(1,3),16):0}get g(){return this.color?Number.parseInt(this.color.substring(3,5),16):0}get b(){return this.color?Number.parseInt(this.color.substring(5,7),16):0}onSubmit(n){this.mc.dismiss(n)}onCancel(){this.mc.dismiss()}};e.\u0275fac=function(o){return new(o||e)(E($t),E(Yt))},e.\u0275cmp=ie({type:e,selectors:[["ng-component"]],standalone:!1,decls:36,vars:15,consts:[["mode","md"],[3,"color"],["min","0","max","255",3,"ionChange","value"],["slot","label"],["slot","end"],[4,"ngFor","ngForOf"],["translate","",3,"click"],["expand","block",3,"click"]],template:function(o,r){o&1&&(c(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title")(3,"outline",1),g(4),d(),g(5),x(6,"translate"),d()()(),c(7,"ion-content")(8,"ion-item")(9,"ion-range",2),A("ionChange",function(m){return r.update("r",m)}),c(10,"ion-label",3),g(11,"R"),d(),c(12,"ion-badge",4),g(13),d()()(),c(14,"ion-item")(15,"ion-range",2),A("ionChange",function(m){return r.update("g",m)}),c(16,"ion-label",3),g(17,"G"),d(),c(18,"ion-badge",4),g(19),d()()(),c(20,"ion-item")(21,"ion-range",2),A("ionChange",function(m){return r.update("b",m)}),c(22,"ion-label",3),g(23,"B"),d(),c(24,"ion-badge",4),g(25),d()()(),c(26,"ion-item")(27,"ion-grid"),P(28,Ia,2,1,"ion-row",5),d()()(),c(29,"ion-footer")(30,"ion-toolbar")(31,"ion-buttons",4)(32,"ion-button",6),A("click",function(){return r.onCancel()}),g(33," Cancel "),d(),c(34,"ion-button",6),A("click",function(){return r.onSubmit(r.color)}),g(35," OK "),d()()()()),o&2&&(a(3),p("color",r.color),a(),W(" ",r.id+1," "),a(),W(" ",r.driver.name||le(6,10,r.placeholder,ve(13,Ea,r.id+1))," "),a(4),p("value",r.r),a(4),me(r.r),a(2),p("value",r.g),a(4),me(r.g),a(2),p("value",r.b),a(4),me(r.b),a(3),p("ngForOf",r.colors))},dependencies:[Ie,ei,Ge,$e,nr,Ye,ni,ir,st,Fe,ct,ri,pr,lt,Qe,Xn,St,Ae,Ke],encapsulation:2});let t=e;return t})();var Ma=t=>({number:t});function Oa(t,e){if(t&1&&(c(0,"ion-note"),g(1),d()),t&2){let i=b(),n=i.$implicit,o=i.index;a(),me(n.code||"#"+(o+1))}}function Pa(t,e){if(t&1){let i=de();c(0,"ion-button",13),A("click",function(){te(i);let o=b().index,r=b();return ne(r.speak(o))}),R(1,"ion-icon",14),d()}}function Da(t,e){if(t&1){let i=de();c(0,"ion-item",7)(1,"ion-button",8),A("click",function(){let o=te(i).index,r=b();return ne(r.chooseColor(o))}),c(2,"outline",9),g(3),d()(),c(4,"ion-input",10),x(5,"translate"),A("ngModelChange",function(o){let r=te(i),s=r.$implicit,m=r.index,l=b();return ne(s.code=l.getCode(s.name=o,m))})("ionChange",function(o){te(i);let r=b();return ne(r.onChangeName(o))}),d(),c(6,"ion-buttons",3),P(7,Oa,2,1,"ion-note",11),x(8,"async"),P(9,Pa,2,0,"ion-button",12),x(10,"async"),R(11,"ion-reorder",3),d()()}if(t&2){let i=e.$implicit,n=e.index,o=b();a(2),p("color",i.color),a(),W(" ",n+1," "),a(),p("ngModel",i.name)("placeholder",le(5,6,o.placeholder,ve(13,Ma,n+1))),a(3),p("ngIf",M(8,9,o.orientation)=="landscape"),a(2),p("ngIf",M(10,11,o.orientation)=="landscape")}}var wi=(()=>{let e=class e{constructor(n,o,r,s,m,l,_){this.app=n,this.cu=o,this.logger=r,this.settings=s,this.mc=m,this.speech=l,this.translate=_,this.placeholder="Driver {{number}}",this.orientation=n.orientation}ngOnInit(){this.settings.getDrivers().pipe(Ce(1)).toPromise().then(n=>{this.drivers=n}).catch(n=>{this.logger.error("Error getting drivers",n)})}ngOnDestroy(){this.settings.setDrivers(this.drivers).catch(n=>{this.logger.error("Error setting drivers",n)})}getCode(n,o){let r=n.replace(/\W/g,"").toUpperCase(),s=this.drivers.filter((m,l)=>l!==o).map(m=>m.code);for(let m=2;m<r.length;++m){let l=r.substr(0,2)+r.substr(m,1);if(s.indexOf(l)===-1)return l}}reorderItems(n){let o=this.drivers[n.detail.from];this.drivers.splice(n.detail.from,1),this.drivers.splice(n.detail.to,0,o),n.detail.complete()}chooseColor(n){return this.mc.create({component:ps,componentProps:{id:n,driver:this.drivers[n]}}).then(o=>{o.onDidDismiss().then(r=>{r.data&&(this.drivers[n].color=r.data)}),o.present()})}speak(n){this.getDriverName(n).then(o=>{this.speech.speak(o)})}pressCodeButton(){this.cu.value.trigger(sn.CODE)}onChangeName(n){n?.target?.getInputElement().then(o=>o.blur())}getDriverName(n){return this.drivers[n]&&this.drivers[n].name?Promise.resolve(this.drivers[n].name):this.translate.get(this.placeholder,{number:n+1}).toPromise()}};e.\u0275fac=function(o){return new(o||e)(E(pt),E(Xt),E(be),E(Be),E(Yt),E(xn),E(vn))},e.\u0275cmp=ie({type:e,selectors:[["ng-component"]],standalone:!1,decls:13,vars:1,consts:[["slot","start"],["defaultHref","/"],["translate",""],["slot","end"],["fill","outline","shape","round",3,"click"],["disabled","false",3,"ionItemReorder"],["class","driver",4,"ngFor","ngForOf"],[1,"driver"],["slot","start","size","large","fill","clear",1,"ion-no-padding",3,"click"],[3,"color"],["clearInput","","enterkeyhint","done",3,"ngModelChange","ionChange","ngModel","placeholder"],[4,"ngIf"],["fill","clear",3,"click",4,"ngIf"],["fill","clear",3,"click"],["name","volume-high-sharp"]],template:function(o,r){o&1&&(c(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),R(3,"ion-back-button",1),d(),c(4,"ion-title")(5,"span",2),g(6,"Drivers"),d()(),c(7,"ion-buttons",3)(8,"ion-button",4),A("click",function(){return r.pressCodeButton()}),g(9," CODE "),d()()()(),c(10,"ion-content")(11,"ion-reorder-group",5),A("ionItemReorder",function(m){return r.reorderItems(m)}),P(12,Da,12,15,"ion-item",6),d()()),o&2&&(a(12),p("ngForOf",r.drivers))},dependencies:[Ie,we,wt,Gt,Ge,$e,Ye,st,at,ii,Fe,ar,cr,lr,lt,Qe,Jn,si,St,Ae,ze,Ke],encapsulation:2});let t=e;return t})();var us=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Ee({imports:[rt,_n,Xe,ut]});let t=e;return t})();function Ra(t,e){if(t&1){let i=de();c(0,"ion-item",2),A("click",function(){te(i);let o=b().$implicit,r=b();return ne(r.onSelect(o))}),c(1,"ion-label")(2,"h2"),g(3),d(),c(4,"h4"),g(5),d()()()}if(t&2){let i=b().$implicit;a(3),me(i.name),a(2),me(i.address)}}function La(t,e){if(t&1&&P(0,Ra,6,2,"ion-item",1),t&2){let i=e.$implicit,n=b();p("ngIf",!i.equals(n.selected))}}var Ti=(()=>{let e=class e{constructor(n,o,r,s,m){this.backends=n,this.logger=o,this.platform=r,this.settings=s,this.toast=m,this.subscription=new pn}ngOnInit(){this.platform.ready().then(()=>{let n=this.backends.map(o=>o.scan().pipe(Wn(r=>(this.logger.error("Scan error:",r),this.toast.showLongCenter(r.toString()),Pt()))));this.peripherals=Ne(n).pipe(et(o=>o),se(o=>o.type!="demo"||this.demoControlUnit),Ue(o=>{!this.selected&&o.type=="web-bluetooth"&&this.onSelect(o)}),_t((o,r)=>o.concat(r),[]))}),this.subscription.add(this.settings.getConnection().subscribe(n=>{this.demoControlUnit=n.demoControlUnit}))}ngOnDestroy(){this.subscription.unsubscribe()}onSelect(n){this.settings.getConnection().pipe(Ce(1)).subscribe(o=>{this.settings.setConnection(Object.assign({},o,{type:n.type,name:n.name,address:n.address}))})}};e.\u0275fac=function(o){return new(o||e)(E(Oe),E(be),E(Tt),E(Be),E(li))},e.\u0275cmp=ie({type:e,selectors:[["connections"]],inputs:{selected:"selected"},standalone:!1,decls:2,vars:3,consts:[["ngFor","",3,"ngForOf"],["button","","menuClose","",3,"click",4,"ngIf"],["button","","menuClose","",3,"click"]],template:function(o,r){o&1&&(P(0,La,1,1,"ng-template",0),x(1,"async")),o&2&&p("ngForOf",M(1,1,r.peripherals))},dependencies:[Ie,we,Fe,ct,ze],encapsulation:2});let t=e;return t})();var ds=(()=>{let e=class e{transform(n){return n?n.replace(/^5(\d)(\d+)$/,"$1.$2"):"..."}};e.\u0275fac=function(o){return new(o||e)},e.\u0275pipe=Do({name:"cuversion",type:e,pure:!0,standalone:!1}),e.\u0275prov=Se({token:e,factory:e.\u0275fac});let t=e;return t})();function Aa(t,e){t&1&&(c(0,"span"),g(1,"\u2026"),d())}var ms=(()=>{let e=class e{constructor(n,o,r,s){this.alert=n,this.settings=o,this.controller=r,this.options=new ui,this.params=s.data}get sectors(){return this.options.sectors}set sectors(n){this.options.sectors=n,this.settings.setOptions(this.options),this.dismiss()}get fixedOrder(){return this.options.fixedorder}set fixedOrder(n){this.options.fixedorder=n,this.settings.setOptions(this.options),this.dismiss()}get speech(){return this.options.speech}set speech(n){this.options.speech=n,this.settings.setOptions(this.options),this.dismiss()}ngOnInit(){this.subscription=this.settings.getOptions().subscribe(n=>{this.options=n})}ngOnDestroy(){this.subscription.unsubscribe()}onRestart(){this.dismiss().then(()=>{this.params.active?this.alert.show({message:"Restart "+this.params.mode+"?",buttons:[{text:"Cancel",role:"cancel"},{text:"OK",handler:()=>this.params.restart()}]}):this.params.restart()})}onCancel(){this.dismiss().then(()=>{this.params.active?this.alert.show({message:"Cancel "+this.params.mode+"?",buttons:[{text:"Cancel",role:"cancel"},{text:"OK",handler:()=>this.params.cancel()}]}):this.params.cancel()})}dismiss(){return this.controller.dismiss({})}};e.\u0275fac=function(o){return new(o||e)(E(yn),E(Be),E(Qt),E($t))},e.\u0275cmp=ie({type:e,selectors:[["ng-component"]],standalone:!1,decls:20,vars:5,consts:[["translate","",3,"ngModelChange","ngModel"],["button","",3,"click","disabled"],["translate",""],["button","",3,"click"],[4,"ngIf"]],template:function(o,r){o&1&&(c(0,"ion-item-group")(1,"ion-item")(2,"ion-checkbox",0),zt("ngModelChange",function(m){return qt(r.fixedOrder,m)||(r.fixedOrder=m),m}),g(3,"Order by number"),d()(),c(4,"ion-item")(5,"ion-checkbox",0),zt("ngModelChange",function(m){return qt(r.sectors,m)||(r.sectors=m),m}),g(6,"Sector times"),d()(),c(7,"ion-item")(8,"ion-checkbox",0),zt("ngModelChange",function(m){return qt(r.speech,m)||(r.speech=m),m}),g(9,"Notifications"),d()(),c(10,"ion-item",1),A("click",function(){return r.onCancel()}),c(11,"ion-label")(12,"span",2),g(13,"Cancel"),d(),g(14,"\u2026"),d()(),c(15,"ion-item",3),A("click",function(){return r.onRestart()}),c(16,"ion-label")(17,"span",2),g(18,"Restart"),d(),P(19,Aa,2,0,"span",4),d()()()),o&2&&(a(2),Zt("ngModel",r.fixedOrder),a(3),Zt("ngModel",r.sectors),a(3),Zt("ngModel",r.speech),a(2),p("disabled",!r.params.active),a(9),p("ngIf",r.params.active))},dependencies:[we,wt,Gt,ti,Fe,Cn,ct,bn,Ae],encapsulation:2});let t=e;return t})();var fs=500;function Ba(t,e){let i=0;for(;t!==e;)i|=1<<t,++t;return i}function ja(t,e){let i=t-e;return isNaN(i)?isNaN(t)?isNaN(e)?0:1:-1:i}function hs(t,e){return(t.best[0]||1/0)-(e.best[0]||1/0)}function Va(t,e){return e.laps-t.laps||ja(t.time,e.time)||t.id-e.id}var Ua={practice:hs,qualifying:hs,race:Va},Si=class{constructor(e,i){this.cu=e,this.options=i,this.finished=new Mn(!1),this.yellowFlag=new Mn(!1),this.started=!1,this.stopped=!1,this.active=0,this.realMask=null;let n=Ua[i.mode],o=Un(e.getStart().pipe(Pe(),se(l=>l!=0)),e.getState().pipe(se(l=>l=="connected"))).pipe(F(l=>{e.setMask(this.mask)})),r=e.getTimer().pipe(se(([l])=>!(this.mask&1<<l)),_t(([l,[_,y,I]],[C,v,O])=>{let H=Date.now();return v<_&&(y=(H-I+_||0)-v),[[C,v+y,O],[v,y,H]]},[[1/0,0,NaN],[1/0,0,NaN]]),F(([l])=>l)),s=e.getFuel(),m=e.getPit();this.mask=(i.auto?0:64)|(i.pace?0:128),i.drivers?(this.mask|=Ba(i.drivers,6),this.grid=this.createGrid(r,s,m,~this.mask&255)):this.grid=this.createGrid(r,s,m),this.ranking=o.pipe(nt(null),Hn(this.grid),F(([l,_])=>_),et(l=>l),_t((l,_)=>{let y=[...l];return y[_.id]=_,y},[]),F(l=>{let _=l.filter(y=>!!y);return _.sort(n),_})),this.currentLap=this.grid.pipe(et(l=>l),_t((l,_)=>l>_.laps?l:this.finished.value||isNaN(_.time)?_.laps:_.laps+1,0),nt(0),en(1),Jt(),Pe()),this.allFinished=this.ranking.pipe(Hn(this.finished),F(([l,_])=>_&&l.every(y=>y.finished)),nt(!1),en(1),Jt(),Pe()),i.time?this.timer=Vn(fs).pipe(fn(e.getStart(),e.getState()),se(([l,_,y])=>this.started&&(!this.options.pause||_==0&&y=="connected")),_t((l,_)=>Math.max(0,l-fs),i.time),Ue(l=>{l==0&&(this.stopped=!0,this.finish())}),mn(),nt(i.time)):this.timer=fo,this.cu.setMask(this.mask),this.cu.clearPosition(),this.cu.reset()}start(){this.started=!0}stop(){this.stopped=!0,this.finish()}toggleYellowFlag(){let e=this.yellowFlag.value;this.yellowFlag.value?(this.mask=this.realMask,this.realMask=null):(this.realMask=this.mask,this.mask=255),this.cu.setMask(this.mask),this.yellowFlag.next(!e)}createGrid(e,i,n,o=0){let r=new Array;for(let s=0;o;++s)o&1&&r.push([s,NaN,0]),o>>>=1;return e.pipe(nt(...r),yo(([s])=>s),F(s=>(this.active|=1<<s.key,s.pipe(_t(([l,_,y,I],[C,v,O])=>{let H=l[l.length-1]||[];if(O&&v>(H.length>=O?H[O-1]:-1/0)+this.options.minLapTime)if(O===1)l.push([v]),_[0]=v-H[0],y[0]=Math.min(_[0],y[0]||1/0),H.length>1&&(_[H.length]=v-H[H.length-1],y[H.length]=Math.min(_[H.length],y[H.length]||1/0)),!I&&this.isFinished(l.length-1)&&(this.finish(C),I=!0);else{let U=O-1;H[U]=v,_[U]=v-H[U-1],y[U]=Math.min(_[U],y[U]||1/0)}return[l,_,y,I]},[[],[],[],!1])).pipe(Hn(n.pipe(F(l=>(l&~this.mask&1<<s.key)!=0),Pe(),_t(([l],_)=>[_?l+1:l,_],[0,!1])),i.pipe(F(l=>l[s.key]),Pe())),F(([[l,_,y,I],[C,v],O])=>{let H=l.length?l.length-1:0,U=l[l.length-1]||[],ae=l[l.length-2]||[];return{id:s.key,time:U[0],laps:H,last:_,best:y,times:l,fuel:O,pit:v,pits:C,sector:U.length-1||ae.length,finished:I}}),en(1),Jt()))),en(),Jt())}finish(e){let i=this.mask;this.mask|=~this.active&255,e!==void 0&&(this.mask|=1<<e),i!=this.mask&&this.cu.setMask(this.mask),e!==void 0&&this.cu.setFinished(e),this.finished.next(!0)}isFinished(e){return this.stopped||this.options.laps&&e>=this.options.laps?!0:!!(!this.options.slotmode&&this.finished.value)}};var Wa=t=>({number:t});function Ha(t,e){if(t&1){let i=de();c(0,"leaderboard-item",3),A("click",function(){let o=te(i).$implicit,r=b();return ne(r.showDetails(o))}),d()}if(t&2){let i=e.$implicit,n=e.odd,o=b();p("ngClass",n?"odd":"even")("fields",o.fields)("item",i)("ranked",o.ranked)("best",o.best)}}function Za(t,e){if(t&1&&R(0,"leaderboard-lap",12),t&2){let i=e.$implicit,n=e.odd,o=e.index,r=e.count,s=b(2);p("ngClass",n?"odd":"even")("lap",r-o)("item",s.detail)("times",i)("best",s.best)("last",s.detail==null?null:s.detail.laptimes[o+1])("intlap",s.intlaps[s.detail==null?null:s.detail.id])("fields",s.detailFields)}}function qa(t,e){if(t&1){let i=de();c(0,"ion-header")(1,"ion-toolbar",4)(2,"ion-title")(3,"outline",5),g(4),d(),g(5),x(6,"translate"),d(),c(7,"ion-buttons",6)(8,"ion-button",7),A("click",function(){te(i);let o=b();return ne(o.modal.dismiss())}),R(9,"ion-icon",8),d()()()(),c(10,"ion-content",9),R(11,"leaderboard-head",10),P(12,Za,1,8,"leaderboard-lap",11),d()}if(t&2){let i=b();a(3),p("color",i.detail==null||i.detail.driver==null?null:i.detail.driver.color),a(),W(" ",(i.detail==null?null:i.detail.position)+1," "),a(),W(" ",(i.detail==null||i.detail.driver==null?null:i.detail.driver.name)||le(6,5,i.placeholder,ve(8,Wa,(i.detail==null?null:i.detail.id)+1))," "),a(6),p("fields",i.detailFields),a(),p("ngForOf",i.detail==null?null:i.detail.laptimes)}}var za=[{practice:["bestlap gap int lastlap laps status","bestlap sector1 sector2 sector3 lastlap status"],qualifying:["bestlap gap int lastlap laps status","bestlap sector1 sector2 sector3 lastlap status"],race:["time bestlap lastlap laps status","time sector1 sector2 sector3 lastlap status"]},{practice:["bestlap gap int lastlap laps fuel status","bestlap sector1 sector2 sector3 lastlap fuel status"],qualifying:["bestlap gap int lastlap laps fuel status","bestlap sector1 sector2 sector3 lastlap fuel status"],race:["time bestlap lastlap laps pits fuel status","time sector1 sector2 sector3 lastlap fuel status"]}],Ga=["lap laptime gap int status","lap laptime sector1 sector2 sector3 status"];var Ei=(()=>{let e=class e{set items(n){if(this._items=n,n?(this.ranked=[...n],this.ranked.sort((o,r)=>o.position-r.position),this.best=n.map(o=>o.best).reduce((o,r)=>(r.forEach((s,m)=>{s<(o[m]||1/0)&&(o[m]=s)}),o),[])):(this.ranked=n,this.best=[]),this.detail){for(let o of n)if(o.id==this.detail.id){this.detail=Object.assign({},o,{laptimes:this.getLapTimes(o)});break}this.intlaps=this.getIntLaps(n)}}get items(){return this._items}get fields(){let n=za[this.pitlane?1:0][this.mode][this.sectors?1:0];return((this.platform.isPortrait()?"code":"number name")+" "+n).split(/\s+/)}get detailFields(){return Ga[this.sectors?1:0].split(/\s+/)}constructor(n,o){this.platform=o,this.placeholder="Driver {{number}}",this.detail=null,this.subscription=o.resize.subscribe(()=>n.markForCheck())}getLapTimes(n){let o=[];for(let r=n.times.length-2;r>=0;--r){let s=[n.times[r+1]?.[0]].concat(n.times[r]);o.push(s)}return o}getIntLaps(n){let o={},r=n.map(s=>[s.id,s.best[0]]).sort((s,m)=>s[1]-m[1]);return r.map(([s,m],l)=>[s,l?r[l-1][1]:m]).forEach(([s,m])=>{o[s]=m}),o}showDetails(n){this.detail=Object.assign({},n,{laptimes:this.getLapTimes(n)}),this.intlaps=this.getIntLaps(this._items)}onWillDismissDetails(n){this.detail=null}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)(E($n),E(Tt))},e.\u0275cmp=ie({type:e,selectors:[["leaderboard"]],viewQuery:function(o,r){if(o&1&&Rt(ai,5),o&2){let s;Lt(s=Nt())&&(r.modal=s.first)}},inputs:{mode:"mode",sectors:"sectors",pitlane:"pitlane",items:"items"},standalone:!1,decls:4,vars:4,consts:[[1,"row",3,"fields","pos"],["class","row",3,"ngClass","fields","item","ranked","best","click",4,"ngFor","ngForOf"],[3,"willDismiss","isOpen"],[1,"row",3,"click","ngClass","fields","item","ranked","best"],["mode","md"],[3,"color"],["slot","end"],[3,"click"],["name","close-sharp"],[1,"ion-padding"],[1,"row",3,"fields"],["class","row",3,"ngClass","lap","item","times","best","last","intlap","fields",4,"ngFor","ngForOf"],[1,"row",3,"ngClass","lap","item","times","best","last","intlap","fields"]],template:function(o,r){o&1&&(R(0,"leaderboard-head",0),P(1,Ha,1,5,"leaderboard-item",1),c(2,"ion-modal",2),A("willDismiss",function(m){return r.onWillDismissDetails(m)}),P(3,qa,13,10,"ng-template"),d()),o&2&&(p("fields",r.fields)("pos",!0),a(),p("ngForOf",r.items),a(),p("isOpen",r.detail!=null))},styles:['@charset "UTF-8";@media (orientation: portrait){[_nghost-%COMP%]{font-size:3vw}}@media (orientation: landscape){[_nghost-%COMP%]{font-size:2.5vw}ion-modal   [_nghost-%COMP%]{font-size:1.5em!important}}[_nghost-%COMP%]{display:block;width:100%}leaderboard-head[_ngcontent-%COMP%]{margin:0 2px}leaderboard-item[_ngcontent-%COMP%]{margin:0 2px 4px}leaderboard-lap[_ngcontent-%COMP%]{margin:0 2px 4px}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;width:100%}.row.odd[_ngcontent-%COMP%]{background-color:var(--ion-color-step-100)}.row.even[_ngcontent-%COMP%]{background-color:var(--ion-color-step-200)}.cell[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:1;padding:.25em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.position[_ngcontent-%COMP%]{text-align:left;width:1.9em;padding-left:0!important;padding-right:0!important}.number[_ngcontent-%COMP%]{text-align:left;width:1.65em}.lap[_ngcontent-%COMP%]{text-align:left;width:2.5em}.name[_ngcontent-%COMP%]{flex-basis:4em;flex-grow:1;text-align:left}.code[_ngcontent-%COMP%]{flex-basis:3em;flex-grow:1;text-align:left}.time[_ngcontent-%COMP%]{text-align:right;width:6em}.bestlap[_ngcontent-%COMP%], .lastlap[_ngcontent-%COMP%], .laptime[_ngcontent-%COMP%]{text-align:right;width:5em}.sector1[_ngcontent-%COMP%], .sector2[_ngcontent-%COMP%], .sector3[_ngcontent-%COMP%]{text-align:right;width:4.5em}.gap[_ngcontent-%COMP%], .int[_ngcontent-%COMP%]{text-align:right;width:5em}.laps[_ngcontent-%COMP%], .pits[_ngcontent-%COMP%]{text-align:right;width:3em}.fuel[_ngcontent-%COMP%]{text-align:left;width:4.5em}.status[_ngcontent-%COMP%]{padding-right:0!important;text-align:left;width:2em}.status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:75%}.status[_ngcontent-%COMP%]   span.inpit[_ngcontent-%COMP%]{color:#fff}.status[_ngcontent-%COMP%]   span.pitenter[_ngcontent-%COMP%]{color:#ff4500}.status[_ngcontent-%COMP%]   span.pos-up[_ngcontent-%COMP%]{color:#0f0}.status[_ngcontent-%COMP%]   span.pos-up[_ngcontent-%COMP%]:before{content:"\\25b2";display:inline-block;width:1em}.status[_ngcontent-%COMP%]   span.pos-dn[_ngcontent-%COMP%]{color:#ff4500}.status[_ngcontent-%COMP%]   span.pos-dn[_ngcontent-%COMP%]:before{content:"\\25bc";display:inline-block;width:1em}.status[_ngcontent-%COMP%]   span.pos-eq[_ngcontent-%COMP%]{color:#fff}.status[_ngcontent-%COMP%]   span.pos-eq[_ngcontent-%COMP%]:before{content:"\\25b2";transform:rotate(-90deg);display:inline-block;width:1em}span.title[_ngcontent-%COMP%]{font-size:75%}span.best[_ngcontent-%COMP%]{color:#0f0}span.best.allbest[_ngcontent-%COMP%]{color:#f0f}span.best.notime[_ngcontent-%COMP%], span.best.allbest.notime[_ngcontent-%COMP%]{color:inherit}span.sector[_ngcontent-%COMP%]{color:#ff0!important}gauge[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:linear-gradient(to right,red,#ee0 25%,green 50%,#006400)}'],changeDetection:0});let t=e;return t})();var Ya=(t,e)=>({active:t,blink:e}),gs=(()=>{let e=class e{constructor(){this.blink=!1}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=ie({type:e,selectors:[["startlight"]],inputs:{active:"active",blink:"blink"},standalone:!1,decls:1,vars:4,consts:[[3,"ngClass"]],template:function(o,r){o&1&&R(0,"div",0),o&2&&p("ngClass",nn(1,Ya,r.active,r.blink))},dependencies:[qe],styles:["@keyframes _ngcontent-%COMP%_startlight-blink{0%{background:radial-gradient(circle at 60% 60%,gray,#000 95%,gray)}to{background:radial-gradient(circle at 60% 60%,red,#300 95%,red)}}div[_ngcontent-%COMP%]{display:inline-block;width:1em;height:1em;margin-left:.1em;margin-right:.1em;border-radius:50%;background:radial-gradient(circle at 60% 60%,gray,#000 95%,gray)}div.active[_ngcontent-%COMP%]{background:radial-gradient(circle at 60% 60%,red,#300 95%,red)}div.blink[_ngcontent-%COMP%]{animation-name:_ngcontent-%COMP%_startlight-blink;animation-duration:.5s;animation-iteration-count:infinite;animation-timing-function:linear}"],changeDetection:0});let t=e;return t})();var Xa=t=>({blink:t});function Ka(t,e){if(t&1&&(hn(),R(0,"circle")),t&2){let i=e.$implicit,n=b().$implicit,o=b();Li("cx",n)("cy",i)("r",o.radius)}}function Ja(t,e){if(t&1&&(hn(),c(0,"g"),P(1,Ka,1,3,"circle",1),d()),t&2){let i=b();a(),p("ngForOf",i.yoffsets)}}var _s=(()=>{let e=class e{constructor(){this.radius=.4}ngOnChanges(n){this.xoffsets=[],this.yoffsets=[];for(let o=0;o<this.cols;++o)this.xoffsets.push(o+.5);for(let o=0;o<this.rows;++o)this.yoffsets.push(o+.5)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=ie({type:e,selectors:[["yellow-flag"]],inputs:{cols:"cols",rows:"rows",blink:"blink"},standalone:!1,features:[qn],decls:2,vars:7,consts:[[3,"ngClass"],[4,"ngFor","ngForOf"]],template:function(o,r){o&1&&(hn(),c(0,"svg",0),P(1,Ja,2,1,"g",1),d()),o&2&&(Li("viewBox",No("0 0 ",r.cols," ",r.rows)),p("ngClass",ve(5,Xa,r.blink)),a(),p("ngForOf",r.xoffsets))},dependencies:[qe,Ie],styles:["@keyframes _ngcontent-%COMP%_blink-yellow-flag{0%{color:#ff0}50%{color:#444}to{color:#ff0}}svg[_ngcontent-%COMP%]{fill:currentColor;color:#444;height:1em;padding:6px;border-radius:8px;box-shadow:0 0 2px #444,inset 0 0 2px #666}.blink[_ngcontent-%COMP%]{color:#ff0;animation-name:_ngcontent-%COMP%_blink-yellow-flag;animation-iteration-count:infinite;animation-duration:1s}"],changeDetection:0});let t=e;return t})();var bs=(()=>{let e=class e{set cu(n){if(n){let o=n.getStart().pipe(Pe()),r=n.getState();this.lights=o.pipe(F(s=>s==1?5:s>1&&s<7?s-1:0)),this.blink=un(o,r).pipe(F(([s,m])=>s>=8||m!=="connected")),this.keys=n.getVersion().then(s=>s>="5331")}else this.lights=Je(0),this.blink=Je(!1),this.keys=Promise.resolve(!1);this.controlUnit=n}get cu(){return this.controlUnit}constructor(){this.onYellowFlag=new Gn}togglePaceCar(){this.cu&&this.cu.trigger(sn.PACE_CAR)}toggleStart(){this.cu&&this.cu.trigger(sn.START)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=ie({type:e,selectors:[["race-control"]],inputs:{cu:"cu",yellowFlag:"yellowFlag"},outputs:{onYellowFlag:"onYellowFlag"},standalone:!1,decls:30,vars:40,consts:[["slot","start"],[3,"click","disabled"],["viewBox","0 0 9 5"],["text-anchor","middle","x","50%","y","2","dy","0.3","font-size","2","textLength","8","lengthAdjust","spacingAndGlyphs"],["text-anchor","middle","x","50%","y","4","dy","0.3","font-size","2","textLength","8","lengthAdjust","spacingAndGlyphs"],["expand","full","fill","clear",1,"icon-only",3,"click","disabled"],[3,"active","blink"],["slot","end"],[3,"blink","cols","rows"]],template:function(o,r){o&1&&(c(0,"ion-toolbar")(1,"ion-buttons",0)(2,"ion-button",1),x(3,"async"),A("click",function(){return r.togglePaceCar()}),c(4,"div"),hn(),c(5,"svg",2)(6,"text",3),g(7,"PACE CAR"),d(),c(8,"text",4),g(9,"ESC"),d()()()()(),Io(),c(10,"ion-button",5),x(11,"async"),A("click",function(){return r.toggleStart()}),R(12,"startlight",6),x(13,"async"),x(14,"async"),R(15,"startlight",6),x(16,"async"),x(17,"async"),R(18,"startlight",6),x(19,"async"),x(20,"async"),R(21,"startlight",6),x(22,"async"),x(23,"async"),R(24,"startlight",6),x(25,"async"),x(26,"async"),d(),c(27,"ion-buttons",7)(28,"ion-button",1),A("click",function(m){return r.onYellowFlag.emit(m)}),R(29,"yellow-flag",8),d()()()),o&2&&(a(2),p("disabled",!M(3,16,r.keys)),a(8),p("disabled",!M(11,18,r.keys)),a(2),p("active",M(13,20,r.lights)>=1)("blink",M(14,22,r.blink)),a(3),p("active",M(16,24,r.lights)>=2)("blink",M(17,26,r.blink)),a(3),p("active",M(19,28,r.lights)>=3)("blink",M(20,30,r.blink)),a(3),p("active",M(22,32,r.lights)>=4)("blink",M(23,34,r.blink)),a(3),p("active",M(25,36,r.lights)>=5)("blink",M(26,38,r.blink)),a(4),p("disabled",!r.cu),a(),p("blink",r.yellowFlag)("cols",9)("rows",5))},dependencies:[Ge,$e,Qe,gs,_s,ze],styles:["@media (orientation: portrait){ion-toolbar[_ngcontent-%COMP%]{font-size:9vw}}@media (orientation: landscape){ion-toolbar[_ngcontent-%COMP%]{font-size:6vw}}ion-button[_ngcontent-%COMP%]{font-size:inherit;height:100%;text-align:center;white-space:nowrap}ion-button[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:currentColor;height:1em;font-weight:700;letter-spacing:normal;padding:6px;border-radius:8px;box-shadow:0 0 2px #444,inset 0 0 2px #666}"],changeDetection:0});let t=e;return t})();function ic(t,e){t&1&&R(0,"checkerboard",8),t&2&&p("cols",9)("rows",5)}function oc(t,e){t&1&&(yt(0),c(1,"span",9),g(2,"Free Practice"),d(),xt())}function rc(t,e){t&1&&(yt(0),c(1,"span",9),g(2,"Qualifying"),d(),xt())}function sc(t,e){t&1&&R(0,"span")}function ac(t,e){if(t&1&&(g(0),x(1,"translate")),t&2){let i=b(4);W(" ",le(1,1,"Lap {{count}}/{{total}}",i.laps)," ")}}function cc(t,e){if(t&1&&(g(0),x(1,"translate")),t&2){let i=b(4);W(" ",le(1,1,"Lap {{count}}",i.laps)," ")}}function lc(t,e){if(t&1&&(c(0,"span"),P(1,sc,1,0,"span",11)(2,ac,2,4,"ng-template",null,2,on)(4,cc,2,4,"ng-template",null,3,on),d()),t&2){let i=Ht(3),n=Ht(5),o=b(3);a(),p("ngIf",o.laps.total)("ngIfThen",i)("ngIfElse",n)}}function pc(t,e){if(t&1&&(c(0,"span"),g(1),x(2,"translate"),d()),t&2){let i=b(4);a(),W(" ",le(2,1,"{{total}} Laps",i.laps)," ")}}function uc(t,e){if(t&1&&P(0,pc,3,4,"span",10),t&2){b(2);let i=Ht(3),n=b();p("ngIf",n.laps.total)("ngIfElse",i)}}function dc(t,e){if(t&1&&(c(0,"span"),P(1,lc,6,3,"span",10)(2,uc,1,2,"ng-template",null,1,on),d()),t&2){let i=Ht(3),n=b(2);a(),p("ngIf",n.laps.count)("ngIfElse",i)}}function mc(t,e){t&1&&(c(0,"span",9),g(1,"Race"),d())}function fc(t,e){if(t&1&&(yt(0),P(1,dc,4,2,"span",10)(2,mc,2,0,"ng-template",null,0,on),xt()),t&2){let i=Ht(3),n=b();a(),p("ngIf",n.laps)("ngIfElse",i)}}function hc(t,e){t&1&&R(0,"checkerboard",8),t&2&&p("cols",9)("rows",5)}function gc(t,e){if(t&1&&(c(0,"span",12),g(1),x(2,"time"),d()),t&2){let i=b();a(),W(" ",le(2,1,i.time,"h:mm:ss")," ")}}var vs=(()=>{let e=class e{constructor(){}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=ie({type:e,selectors:[["race-title"]],inputs:{mode:"mode",laps:"laps",time:"time",finished:"finished"},standalone:!1,decls:8,vars:7,consts:[["race",""],["race0",""],["race1",""],["race2",""],[3,"cols","rows",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["style","float: right",4,"ngIf"],[3,"cols","rows"],["translate",""],[4,"ngIf","ngIfElse"],[4,"ngIf","ngIfThen","ngIfElse"],[2,"float","right"]],template:function(o,r){o&1&&(c(0,"ion-title"),P(1,ic,1,2,"checkerboard",4),c(2,"span",5),P(3,oc,3,0,"ng-container",6)(4,rc,3,0,"ng-container",6)(5,fc,4,2,"ng-container",6),d(),P(6,hc,1,2,"checkerboard",4)(7,gc,3,4,"span",7),d()),o&2&&(a(),p("ngIf",r.finished),a(),p("ngSwitch",r.mode),a(),p("ngSwitchCase","practice"),a(),p("ngSwitchCase","qualifying"),a(),p("ngSwitchCase","race"),a(),p("ngIf",r.finished),a(),p("ngIf",r.time&&!r.finished))},dependencies:[we,it,ot,lt,pi,Ae,wn,Ke],encapsulation:2,changeDetection:0});let t=e;return t})();function Cc(t,e){if(t&1){let i=de();c(0,"ion-button",5),A("click",function(){te(i);let o=b();return ne(o.toggleSpeech())}),R(1,"ion-icon",9),d()}if(t&2){let i=b();a(),p("name",i.options!=null&&i.options.speech?"volume-high-sharp":"volume-mute-sharp")}}function vc(t,e){if(t&1&&(c(0,"div"),R(1,"leaderboard",10),x(2,"async"),x(3,"async"),x(4,"async"),d()),t&2){let i=b();a(),p("mode",i.mode)("items",M(2,4,i.items))("pitlane",M(3,6,i.pitlane))("sectors",M(4,8,i.sectors))}}function yc(t,e){t&1&&(c(0,"div",11)(1,"h1",12),g(2,"Welcome to Open Lap!"),d(),c(3,"p",12),g(4," Please select a Control Unit device from the menu. "),d(),c(5,"p",12),g(6," If no devices are listed, please make sure that Bluetooth is enabled. "),d()())}var xc={position:(t,e)=>t.position-e.position,number:(t,e)=>t.id-e.id},no=(()=>{let e=class e{constructor(n,o,r,s,m,l,_,y){this.cu=n,this.app=o,this.logger=r,this.settings=s,this.speech=m,this.popover=l,this.translate=_,this.subscription=new pn;let I=y.snapshot.paramMap.get("mode");switch(I){case"practice":case"qualifying":case"race":this.mode=I;break;default:this.mode="practice"}let C=n.pipe(se(v=>!!v),et(v=>v.getMode()),nt(0),Pe());this.pitlane=C.pipe(F(v=>(v&3)!=0)),this.sectors=s.getOptions().pipe(F(v=>v.sectors)),this.start=n.pipe(se(v=>!!v),et(v=>v.getStart()),Pe()),this.orientation=o.orientation,this.legacyAndroid=o.isAndroid()&&o.isCordova()?o.getDeviceInfo().then(v=>v.version<"12"):Promise.resolve(!1)}ngOnInit(){this.subscription.add(un([this.cu,this.getRaceOptions(this.mode)]).subscribe(([n,o])=>{n&&o?this.session=this.startSession(n,o):this.session=null})),this.subscription.add(this.settings.getOptions().subscribe(n=>{this.options=n}))}startSession(n,o){let r=new Si(n,o);this.lapcount=r.currentLap.pipe(F(C=>({count:C,total:o.laps})),nt({count:0,total:o.laps}));let s=this.settings.getDrivers().pipe(De(C=>{let v=C.map((O,H)=>{let U=O.code||"#"+(H+1);return O.name?Je({name:O.name,code:U,color:O.color}):this.getTranslations("Driver {{number}}",{number:H+1}).pipe(F(ae=>({name:ae,code:U,color:O.color})))});return un(v)})),m=[1/0,1/0,1/0,1/0],l=Un(r.grid.pipe(F(C=>C.pipe(dn())),et(C=>C),et(([C,v])=>{let O=[];return v.best.forEach((H,U)=>{(H||1/0)<m[U]&&(m[U]=H,v.laps>=3&&O.push([U?"bests"+U:"bestlap",v.id]))}),!v.finished&&v.time&&(v.fuel<C.fuel&&O.push(["fuel"+v.fuel,v.id]),v.pit&&!C.pit&&O.push(["pitenter",v.id]),!v.pit&&C.pit&&O.push(["pitexit",v.id])),Ne(O)})),r.ranking.pipe(se(C=>C.length>0&&o.mode=="race"),F(C=>C.map(v=>({id:v.id,finished:v.finished}))),dn(),se(([C,v])=>v[0].finished),et(([C,v])=>{let O=[];return!C[0].finished&&v[0].finished&&(v.length>1?O.push(["finished1st",v[0].id]):O.push(["finished",null])),v.length>=2&&!C[1]?.finished&&v[1].finished&&O.push(["finished2nd",v[1].id]),v.length>=3&&!C[2]?.finished&&v[2].finished&&O.push(["finished3rd",v[2].id]),Ne(O)})),r.ranking.pipe(se(C=>C.length!=0&&o.mode=="race"),F(C=>C[0]),dn(),se(([C,v])=>C.id!=v.id),F(([C,v])=>["newleader",v.id])),r.timer.pipe(se(C=>o.time>=12e4&&C<=6e4&&!r.finished.value),Ce(1),F(()=>["oneminute",null])),r.timer.pipe(F(C=>[C,r.finished.value]),dn(),F(([C,v])=>[v[0],C[1]]),se(([C,v])=>C==0&&!v),Ce(1),F(()=>["timeout",null])),r.yellowFlag.pipe(Pe(),So(C=>!C),F(C=>[C?"yellowflag":"greenflag",null])),r.allFinished.pipe(se(C=>C),Ce(1),F(()=>["alldone",null])),this.lapcount.pipe(se(C=>o.laps>=10&&C.count===o.laps-4&&!r.finished.value),Ce(1),F(()=>["fivelaps",null])),this.lapcount.pipe(se(C=>o.laps&&C.count===o.laps&&!r.finished.value),Ce(1),F(()=>["finallap",null])),this.start.pipe(Pe(),se(C=>C===9),F(()=>["falsestart",null]))).pipe(fn(s),F(([[C,v],O])=>[C,v!==null?O[v]:null])),_=this.settings.getOptions().pipe(F(C=>C.fixedorder?"number":"position")),y=[],I=[];return this.items=un([r.ranking,s,_]).pipe(F(([C,v,O])=>{let H=C.map((U,ae)=>(o.mode=="race"&&y[U.id]===void 0&&U.time!==void 0&&(y[U.id]=ae),(!U.pit||U.fuel<I[U.id])&&(I[U.id]=U.fuel),Object.assign({},U,{position:ae,driver:v[U.id],gridpos:y[U.id],refuel:U.pit&&U.fuel>I[U.id]})));return H.sort(xc[O||"position"]),H}),mn()),this.subscriptions&&this.subscriptions.unsubscribe(),this.subscriptions=l.pipe(fn(this.settings.getOptions(),this.settings.getNotifications(),this.getTranslations("notifications"))).subscribe(([[C,v],O,H,U])=>{if(this.logger.debug("Race event: "+C,v),O.speech&&H[C]&&H[C].enabled){let ae=H[C].message||U[C];v&&v.name?this.speech.speak(v.name+": "+ae):this.speech.speak(ae)}}),this.subscriptions.add(this.lapcount.subscribe(C=>{n.setLap(C.count)},C=>{this.logger.error("Lap counter error:",C)},()=>{this.logger.info("Lap counter finished")})),this.subscriptions.add(l.pipe(se(([C])=>C=="alldone"),fn(this.getRaceOptions(o.mode))).subscribe(([[C],v])=>{v.stopfin&&n.toggleStart()})),o.mode!="practice"&&n.getStart().pipe(Ce(1)).toPromise().then(v=>{v===0&&n.toggleStart(),n.getStart().pipe(dn(),se(([O,H])=>O!=0&&H==0),Ce(1)).toPromise().then(()=>{this.logger.info("Start "+o.mode+" mode"),r.start()})}),r}ngOnDestroy(){this.subscription.unsubscribe(),this.subscriptions&&this.subscriptions.unsubscribe(),this.dataSubscription&&this.dataSubscription.unsubscribe()}ionViewDidEnter(){this.backButtonSubscription=this.app.backButton.subscribe(()=>{this.cu.value?this.cu.value.disconnect().catch(n=>{this.logger.error("Error disconnecting from CU:",n)}).then(()=>{this.app.exit()}):this.app.exit()})}ionViewWillLeave(){this.backButtonSubscription.unsubscribe()}restartSession(){this.session&&(this.session=this.startSession(this.session.cu,this.session.options))}cancelSession(){this.session&&this.session.stop()}getRaceOptions(n){switch(n){case"race":return this.settings.getRaceSettings();case"qualifying":return this.settings.getQualifyingSettings();default:return Je(new di("practice"))}}toggleSpeech(){this.options&&this.settings.setOptions(Object.assign({},this.options,{speech:!this.options.speech}))}toggleYellowFlag(){this.session&&this.session.toggleYellowFlag()}showMenu(n){return this.popover.create({component:ms,componentProps:{mode:this.mode,active:this.session&&!this.session.finished.value&&this.mode!="practice",restart:()=>this.restartSession(),cancel:()=>this.cancelSession()},event:n}).then(o=>{o.present()})}getTranslations(n,o){return this.translate.stream(n,o)}};e.\u0275fac=function(o){return new(o||e)(E(Xt),E(pt),E(be),E(Be),E(xn),E(Qt),E(vn),E(Wo))},e.\u0275cmp=ie({type:e,selectors:[["ng-component"]],standalone:!1,decls:22,vars:23,consts:[["nocu",""],["slot","start"],[3,"mode","laps","time","finished"],["slot","end"],[3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","ellipsis-vertical-sharp"],[4,"ngIf","ngIfElse"],[3,"onYellowFlag","cu","yellowFlag"],["slot","icon-only",3,"name"],[3,"mode","items","pitlane","sectors"],[1,"ion-padding"],["translate",""]],template:function(o,r){if(o&1){let s=de();c(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),R(3,"ion-menu-button"),d(),R(4,"race-title",2),x(5,"async"),x(6,"async"),x(7,"async"),c(8,"ion-buttons",3),P(9,Cc,2,1,"ion-button",4),x(10,"async"),c(11,"ion-button",5),A("click",function(l){return te(s),ne(r.showMenu(l))}),R(12,"ion-icon",6),d()()()(),c(13,"ion-content"),P(14,vc,5,10,"div",7),x(15,"async"),P(16,yc,7,0,"ng-template",null,0,on),d(),c(18,"ion-footer")(19,"race-control",8),x(20,"async"),x(21,"async"),A("onYellowFlag",function(){return te(s),ne(r.toggleYellowFlag())}),d()()}if(o&2){let s=Ht(17);a(4),p("mode",r.mode)("laps",M(5,9,r.lapcount))("time",M(6,11,r.session==null?null:r.session.timer))("finished",M(7,13,r.session==null?null:r.session.finished)),a(5),p("ngIf",M(10,15,r.orientation)=="landscape"),a(5),p("ngIf",M(15,17,r.cu))("ngIfElse",s),a(5),p("cu",M(20,19,r.cu))("yellowFlag",M(21,21,r.session==null?null:r.session.yellowFlag))}},dependencies:[we,Ge,$e,Ye,ni,st,at,rr,Qe,Ei,bs,Ae,vs,ze],encapsulation:2});let t=e;return t})();var wc=["time"],Tc=["laps"],Sc=["pause"],Ec=["slotmode"],kc=()=>[1,2,3,4,5,6];function Ic(t,e){t&1&&(c(0,"span",23),g(1,"Free Practice"),d())}function Mc(t,e){t&1&&(c(0,"span",23),g(1,"Qualifying"),d())}function Oc(t,e){t&1&&(c(0,"span",23),g(1,"Race"),d())}function Pc(t,e){if(t&1){let i=de();c(0,"ion-item")(1,"ion-input",24,3),x(3,"translate"),A("ionInput",function(o){te(i);let r=b();return ne(r.onLapsInput(o))})("ionChange",function(o){te(i);let r=b();return ne(r.onChangeLaps(o))}),d()()}t&2&&(a(),p("label",gn(M(3,4,"Number of laps")))("clearInput",!0)("maxlength",5))}function Dc(t,e){if(t&1&&(c(0,"ion-select-option",25),g(1),d()),t&2){let i=e.$implicit;p("value",i),a(),me(i)}}function Rc(t,e){t&1&&(c(0,"ion-item")(1,"ion-toggle",26,4),g(3,"Finish all laps"),d()())}function oo(t){let e=Math.floor(t/36e5),i=Math.floor(t/6e4%60);return(""+e).padStart(1,"0")+":"+(""+i).padStart(2,"0")}function io(t){let[e,i]=t.split(":");return(parseInt(e)*3600+parseInt(i)*60)*1e3}function ys(t){return!t.value||!io(t.value)?{required:!0}:null}function Lc(t){let e=parseInt(t.get("laps").value);return e&&e>0||!ys(t.get("time"))?null:{required:!0}}function Nc(t,e){return t.group({time:new We(oo(e.get("time")||3e5),ys),pause:new We({value:e.get("pause")||!1,disabled:!e.get("time")}),stopfin:new We(e.get("stopfin")||!1),drivers:new We(e.get("drivers")||""),auto:new We(e.get("auto")||!1),pace:new We(e.get("pace")||!1)})}function Fc(t,e){return t.group({laps:new We(e.get("laps")||"0"),time:new We(oo(e.get("time")||0)),pause:new We({value:!!e.get("pause"),disabled:!e.get("time")}),slotmode:new We({value:!!e.get("slotmode"),disabled:!e.get("laps")}),stopfin:new We(e.get("stopfin")||!1),drivers:new We(e.get("drivers")||""),auto:new We(e.get("auto")||!1),pace:new We(e.get("pace")||!1)},{validator:Lc})}var ro=(()=>{let e=class e{constructor(n,o,r){this.mod=r,this.mode=o.get("mode"),this.mode=="race"?this.form=Fc(n,o):this.form=Nc(n,o)}ngAfterViewInit(){this.pauseToggle&&(this.pauseToggle.disabled=this.form.get("pause").disabled),this.slotmodeToggle&&(this.slotmodeToggle.disabled=this.form.get("slotmode").disabled)}onTimeInput(n){let r=n.target.value.replace(/[^0-9]+/g,"").replace(/^0+/,""),s=r.substring(r.length-2).padStart(2,"0"),l=r.substring(0,r.length-2).padStart(1,"0")+":"+s;this.timeInput.value=l,this.form.get("time").setValue(l)}onChangeTime(n){let o=io(n.detail.value);this.timeInput.value=oo(o),o!=0?this.form.get("pause").enable():this.form.get("pause").disable(),this.pauseToggle&&(this.pauseToggle.disabled=this.form.get("pause").disabled),this.timeInput.getInputElement().then(r=>r.blur())}onLapsInput(n){let r=n.target.value.replace(/[^0-9]+/g,"").replace(/^0+/,"")||"0";this.lapsInput.value=r,this.form.get("laps").setValue(r)}onChangeLaps(n){parseInt(n.detail.value||"0")>0?this.form.get("slotmode").enable():this.form.get("slotmode").disable(),this.slotmodeToggle&&(this.slotmodeToggle.disabled=this.form.get("slotmode").disabled),this.lapsInput.getInputElement().then(o=>o.blur())}onSubmit(n){this.mod.dismiss(Object.assign(new di(this.mode),{laps:parseInt(n.laps||"0"),time:io(n.time||"0:00"),pause:n.pause,drivers:n.drivers?parseInt(n.drivers):void 0,auto:n.auto,pace:n.pace,slotmode:n.slotmode,stopfin:n.stopfin}))}onCancel(){this.mod.dismiss()}};e.\u0275fac=function(o){return new(o||e)(E(Xo),E($t),E(Yt))},e.\u0275cmp=ie({type:e,selectors:[["ng-component"]],viewQuery:function(o,r){if(o&1&&(Rt(wc,5),Rt(Tc,5),Rt(Sc,7),Rt(Ec,5)),o&2){let s;Lt(s=Nt())&&(r.timeInput=s.first),Lt(s=Nt())&&(r.lapsInput=s.first),Lt(s=Nt())&&(r.pauseToggle=s.first),Lt(s=Nt())&&(r.slotmodeToggle=s.first)}},standalone:!1,decls:43,vars:27,consts:[["time",""],["pause",""],["stopfin",""],["laps",""],["slotmode",""],["translate","",3,"ngSwitch"],["translate","",4,"ngSwitchCase"],["translate","",4,"ngSwitchDefault"],["slot","start"],[3,"click"],["name","close-sharp"],["slot","end"],["translate","","type","submit",3,"click","disabled"],[3,"formGroup"],["formControlName","time","placeholder","0:00","inputmode","decimal","enterkeyhint","done",1,"right-align",3,"ionInput","ionChange","label","clearInput","maxlength"],[4,"ngIf"],["formControlName","drivers",3,"label","cancelText","okText"],["translate","","value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","auto","translate",""],["formControlName","pace","translate",""],["formControlName","pause","translate",""],["formControlName","stopfin","translate",""],["translate",""],["formControlName","laps","placeholder","0","inputmode","decimal","enterkeyhint","done",1,"right-align",3,"ionInput","ionChange","label","clearInput","maxlength"],[3,"value"],["formControlName","slotmode","translate",""]],template:function(o,r){if(o&1){let s=de();c(0,"ion-header")(1,"ion-toolbar")(2,"ion-title",5),P(3,Ic,2,0,"span",6)(4,Mc,2,0,"span",6)(5,Oc,2,0,"span",7),d(),c(6,"ion-buttons",8)(7,"ion-button",9),A("click",function(){return te(s),ne(r.onCancel())}),R(8,"ion-icon",10),d()(),c(9,"ion-buttons",11)(10,"ion-button",12),A("click",function(){return te(s),ne(r.onSubmit(r.form.value))}),g(11," Start "),d()()()(),c(12,"ion-content")(13,"form",13)(14,"ion-list")(15,"ion-item")(16,"ion-input",14,0),x(18,"translate"),A("ionInput",function(l){return te(s),ne(r.onTimeInput(l))})("ionChange",function(l){return te(s),ne(r.onChangeTime(l))}),d()(),P(19,Pc,4,6,"ion-item",15),c(20,"ion-item")(21,"ion-select",16),x(22,"translate"),x(23,"translate"),x(24,"translate"),c(25,"ion-select-option",17),g(26,"Automatic"),d(),P(27,Dc,2,2,"ion-select-option",18),d()(),c(28,"ion-item")(29,"ion-toggle",19),g(30,"Autonomous Car"),d()(),c(31,"ion-item")(32,"ion-toggle",20),g(33,"Pace Car"),d()(),c(34,"ion-item")(35,"ion-toggle",21,1),g(37,"Stop time when paused"),d()(),P(38,Rc,4,0,"ion-item",15),c(39,"ion-item")(40,"ion-toggle",22,2),g(42,"Stop cars when finished"),d()()()()()}o&2&&(a(2),p("ngSwitch",r.mode),a(),p("ngSwitchCase","practice"),a(),p("ngSwitchCase","qualifying"),a(6),p("disabled",!r.form.valid),a(3),p("formGroup",r.form),a(3),p("label",gn(M(18,18,"Time")))("clearInput",!0)("maxlength",5),a(3),p("ngIf",r.mode=="race"),a(2),p("label",gn(M(22,20,"Number of drivers")))("cancelText",gn(M(23,22,"Cancel")))("okText",gn(M(24,24,"OK"))),a(6),p("ngForOf",Ao(26,kc)),a(11),p("ngIf",r.mode=="race"))},dependencies:[Ie,we,it,ot,Yn,Go,wt,zo,Qo,$o,Yo,Ge,$e,Ye,st,at,ii,Fe,oi,mr,fr,lt,hr,Qe,bn,Kn,Jn,Ae,Ke],encapsulation:2});let t=e;return t})();var Ac=t=>[t,"cell"];function Bc(t,e){t&1&&(c(0,"div",2)(1,"span",3),g(2,"POS"),d()())}function jc(t,e){t&1&&(c(0,"span",3),g(1,"NO"),d())}function Vc(t,e){t&1&&(c(0,"span",3),g(1,"NAME"),d())}function Uc(t,e){t&1&&(c(0,"span",3),g(1,"NAME"),d())}function Wc(t,e){t&1&&(c(0,"span",3),g(1,"TIME"),d())}function Hc(t,e){t&1&&(c(0,"span",3),g(1,"LAST LAP"),d())}function Zc(t,e){t&1&&(c(0,"span",3),g(1,"BEST LAP"),d())}function qc(t,e){t&1&&(c(0,"span",3),g(1,"S1"),d())}function zc(t,e){t&1&&(c(0,"span",3),g(1,"S2"),d())}function Gc(t,e){t&1&&(c(0,"span",3),g(1,"S3"),d())}function $c(t,e){t&1&&(c(0,"span",3),g(1,"GAP"),d())}function Yc(t,e){t&1&&(c(0,"span",3),g(1,"INT"),d())}function Qc(t,e){t&1&&(c(0,"span",3),g(1,"LAPS"),d())}function Xc(t,e){t&1&&(c(0,"span",3),g(1,"PITS"),d())}function Kc(t,e){t&1&&(c(0,"span",3),g(1,"FUEL"),d())}function Jc(t,e){t&1&&R(0,"span",3)}function el(t,e){t&1&&(c(0,"span",3),g(1,"LAP"),d())}function tl(t,e){t&1&&(c(0,"span",3),g(1,"TIME"),d())}function nl(t,e){if(t&1&&(c(0,"div",4),P(1,jc,2,0,"span",5)(2,Vc,2,0,"span",5)(3,Uc,2,0,"span",5)(4,Wc,2,0,"span",5)(5,Hc,2,0,"span",5)(6,Zc,2,0,"span",5)(7,qc,2,0,"span",5)(8,zc,2,0,"span",5)(9,Gc,2,0,"span",5)(10,$c,2,0,"span",5)(11,Yc,2,0,"span",5)(12,Qc,2,0,"span",5)(13,Xc,2,0,"span",5)(14,Kc,2,0,"span",5)(15,Jc,1,0,"span",5)(16,el,2,0,"span",5)(17,tl,2,0,"span",5),d()),t&2){let i=e.$implicit;p("ngSwitch",i)("ngClass",ve(19,Ac,i)),a(),p("ngSwitchCase","number"),a(),p("ngSwitchCase","name"),a(),p("ngSwitchCase","code"),a(),p("ngSwitchCase","time"),a(),p("ngSwitchCase","lastlap"),a(),p("ngSwitchCase","bestlap"),a(),p("ngSwitchCase","sector1"),a(),p("ngSwitchCase","sector2"),a(),p("ngSwitchCase","sector3"),a(),p("ngSwitchCase","gap"),a(),p("ngSwitchCase","int"),a(),p("ngSwitchCase","laps"),a(),p("ngSwitchCase","pits"),a(),p("ngSwitchCase","fuel"),a(),p("ngSwitchCase","status"),a(),p("ngSwitchCase","lap"),a(),p("ngSwitchCase","laptime")}}var xs=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=ie({type:e,selectors:[["leaderboard-head"]],inputs:{fields:"fields",pos:"pos"},standalone:!1,decls:2,vars:2,consts:[["class","position cell",4,"ngIf"],[3,"ngSwitch","ngClass",4,"ngFor","ngForOf"],[1,"position","cell"],[1,"title"],[3,"ngSwitch","ngClass"],["class","title",4,"ngSwitchCase"]],template:function(o,r){o&1&&P(0,Bc,3,0,"div",0)(1,nl,18,21,"div",1),o&2&&(p("ngIf",r.pos),a(),p("ngForOf",r.fields))},dependencies:[qe,Ie,we,it,ot],styles:['@charset "UTF-8";@media (orientation: portrait){[_nghost-%COMP%]{font-size:3vw}}@media (orientation: landscape){[_nghost-%COMP%]{font-size:2.5vw}ion-modal   [_nghost-%COMP%]{font-size:1.5em!important}}[_nghost-%COMP%]{display:block;width:100%}leaderboard-head[_ngcontent-%COMP%]{margin:0 2px}leaderboard-item[_ngcontent-%COMP%]{margin:0 2px 4px}leaderboard-lap[_ngcontent-%COMP%]{margin:0 2px 4px}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;width:100%}.row.odd[_ngcontent-%COMP%]{background-color:var(--ion-color-step-100)}.row.even[_ngcontent-%COMP%]{background-color:var(--ion-color-step-200)}.cell[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:1;padding:.25em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.position[_ngcontent-%COMP%]{text-align:left;width:1.9em;padding-left:0!important;padding-right:0!important}.number[_ngcontent-%COMP%]{text-align:left;width:1.65em}.lap[_ngcontent-%COMP%]{text-align:left;width:2.5em}.name[_ngcontent-%COMP%]{flex-basis:4em;flex-grow:1;text-align:left}.code[_ngcontent-%COMP%]{flex-basis:3em;flex-grow:1;text-align:left}.time[_ngcontent-%COMP%]{text-align:right;width:6em}.bestlap[_ngcontent-%COMP%], .lastlap[_ngcontent-%COMP%], .laptime[_ngcontent-%COMP%]{text-align:right;width:5em}.sector1[_ngcontent-%COMP%], .sector2[_ngcontent-%COMP%], .sector3[_ngcontent-%COMP%]{text-align:right;width:4.5em}.gap[_ngcontent-%COMP%], .int[_ngcontent-%COMP%]{text-align:right;width:5em}.laps[_ngcontent-%COMP%], .pits[_ngcontent-%COMP%]{text-align:right;width:3em}.fuel[_ngcontent-%COMP%]{text-align:left;width:4.5em}.status[_ngcontent-%COMP%]{padding-right:0!important;text-align:left;width:2em}.status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:75%}.status[_ngcontent-%COMP%]   span.inpit[_ngcontent-%COMP%]{color:#fff}.status[_ngcontent-%COMP%]   span.pitenter[_ngcontent-%COMP%]{color:#ff4500}.status[_ngcontent-%COMP%]   span.pos-up[_ngcontent-%COMP%]{color:#0f0}.status[_ngcontent-%COMP%]   span.pos-up[_ngcontent-%COMP%]:before{content:"\\25b2";display:inline-block;width:1em}.status[_ngcontent-%COMP%]   span.pos-dn[_ngcontent-%COMP%]{color:#ff4500}.status[_ngcontent-%COMP%]   span.pos-dn[_ngcontent-%COMP%]:before{content:"\\25bc";display:inline-block;width:1em}.status[_ngcontent-%COMP%]   span.pos-eq[_ngcontent-%COMP%]{color:#fff}.status[_ngcontent-%COMP%]   span.pos-eq[_ngcontent-%COMP%]:before{content:"\\25b2";transform:rotate(-90deg);display:inline-block;width:1em}span.title[_ngcontent-%COMP%]{font-size:75%}span.best[_ngcontent-%COMP%]{color:#0f0}span.best.allbest[_ngcontent-%COMP%]{color:#f0f}span.best.notime[_ngcontent-%COMP%], span.best.allbest.notime[_ngcontent-%COMP%]{color:inherit}span.sector[_ngcontent-%COMP%]{color:#ff0!important}gauge[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:linear-gradient(to right,red,#ee0 25%,green 50%,#006400)}'],changeDetection:0});let t=e;return t})();var il=t=>[t,"cell"],ol=t=>({notime:t}),rl=(t,e,i)=>({best:t,allbest:e,notime:i}),so=(t,e,i)=>({sector:t,best:e,allbest:i});function sl(t,e){if(t&1&&g(0),t&2){let i=b(2);W(" ",i.item.id+1," ")}}function al(t,e){if(t&1&&g(0),t&2){let i=b(2);W(" ",i.item.driver==null?null:i.item.driver.name," ")}}function cl(t,e){if(t&1&&g(0),t&2){let i=b(2);W(" ",i.item.driver==null?null:i.item.driver.code," ")}}function ll(t,e){if(t&1&&(g(0),x(1,"time")),t&2){let i=b(3);W(" ",le(1,1,i.item.time,"m:ss.sss")," ")}}function pl(t,e){if(t&1&&(g(0),x(1,"time")),t&2){let i=b(3);W(" ",le(1,1,i.item.time-i.ranked[0].time,"+s.sss")," ")}}function ul(t,e){t&1&&g(0," +1 Lap ")}function dl(t,e){if(t&1&&g(0),t&2){let i=b(3);W(" +",i.ranked[0].laps-i.item.laps," Laps ")}}function ml(t,e){if(t&1&&(c(0,"span",18),P(1,ll,2,4,"ng-template",19)(2,pl,2,4,"ng-template",20)(3,ul,1,0,"ng-template",21)(4,dl,1,1,"ng-template",22),d()),t&2){let i=b(2);p("ngSwitch",i.item.position==0?"":(i.ranked[0].laps-i.item.laps).toString())}}function fl(t,e){if(t&1&&(c(0,"span",23),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",ve(5,ol,!i.item.best[0])),a(),W(" ",le(2,2,i.item.best[0],"s.sss")||"NO\u2009TIME"," ")}}function hl(t,e){if(t&1&&(g(0),x(1,"time")),t&2){let i=b(2);W(" ",le(1,1,i.item.position&&i.item.best[0]?i.item.best[0]-i.ranked[0].best[0]:null,"+s.sss")," ")}}function gl(t,e){if(t&1&&(g(0),x(1,"time")),t&2){let i=b(2);W(" ",le(1,1,i.item.position&&i.item.best[0]?i.item.best[0]-i.ranked[i.item.position-1].best[0]:null,"+s.sss")," ")}}function _l(t,e){if(t&1&&(c(0,"span",23),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",On(5,rl,i.item.last[0]==i.item.best[0],i.item.last[0]==i.best[0],!i.item.last[0])),a(),W(" ",le(2,2,i.item.last[0],"s.sss")||"NO\u2009TIME"," ")}}function bl(t,e){if(t&1&&(c(0,"span",23),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",On(5,so,i.item.sector==1,i.item.last[1]==i.item.best[1],i.item.last[1]==i.best[1])),a(),W(" ",le(2,2,i.item.last[1],"s.sss")," ")}}function Cl(t,e){if(t&1&&(c(0,"span",23),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",On(5,so,i.item.sector==2,i.item.last[2]==i.item.best[2],i.item.last[2]==i.best[2])),a(),W(" ",le(2,2,i.item.last[2],"s.sss")," ")}}function vl(t,e){if(t&1&&(c(0,"span",23),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",On(5,so,i.item.sector==3,i.item.last[3]==i.item.best[3],i.item.last[3]==i.best[3])),a(),W(" ",le(2,2,i.item.last[3],"s.sss")," ")}}function yl(t,e){if(t&1&&g(0),t&2){let i=b(2);W(" ",i.item.laps," ")}}function xl(t,e){if(t&1&&g(0),t&2){let i=b(2);W(" ",i.item.pits," ")}}function wl(t,e){if(t&1&&(c(0,"gauge",24),g(1,"\xA0"),d()),t&2){let i=b(2);p("max",15)("value",i.item.fuel)}}function Tl(t,e){t&1&&R(0,"checkerboard",27),t&2&&p("cols",7)("rows",5)}function Sl(t,e){if(t&1&&(c(0,"span",23),g(1,"PIT"),d()),t&2){let i=b(3);p("ngClass",i.item.refuel?"inpit":"pitenter")}}function El(t,e){if(t&1&&(c(0,"span",23),g(1),d()),t&2){let i=b(3);p("ngClass",i.item.gridpos>i.item.position?"pos-up":i.item.gridpos<i.item.position?"pos-dn":"pos-eq"),a(),W(" ",i.abs(i.item.gridpos-i.item.position)," ")}}function kl(t,e){if(t&1&&P(0,Tl,1,2,"checkerboard",25)(1,Sl,2,1,"span",26)(2,El,2,2,"span",26),t&2){let i=b(2);p("ngIf",i.item.finished),a(),p("ngIf",!i.item.finished&&i.item.pit),a(),p("ngIf",!i.item.finished&&!i.item.pit&&i.item.gridpos!=null&&i.item.laps&&i.ranked.length>2)}}function Il(t,e){if(t&1&&(c(0,"div",2),P(1,sl,1,1,"ng-template",3)(2,al,1,1,"ng-template",4)(3,cl,1,1,"ng-template",5)(4,ml,5,1,"ng-template",6)(5,fl,3,7,"ng-template",7)(6,hl,2,4,"ng-template",8)(7,gl,2,4,"ng-template",9)(8,_l,3,9,"ng-template",10)(9,bl,3,9,"ng-template",11)(10,Cl,3,9,"ng-template",12)(11,vl,3,9,"ng-template",13)(12,yl,1,1,"ng-template",14)(13,xl,1,1,"ng-template",15)(14,wl,2,2,"ng-template",16)(15,kl,3,3,"ng-template",17),d()),t&2){let i=e.$implicit;p("ngSwitch",i)("ngClass",ve(2,il,i))}}var ws=(()=>{let e=class e{abs(n){return n<0?-n:n}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=ie({type:e,selectors:[["leaderboard-item"]],inputs:{fields:"fields",item:"item",ranked:"ranked",best:"best"},standalone:!1,decls:3,vars:3,consts:[[1,"position","cell",3,"color"],[3,"ngSwitch","ngClass",4,"ngFor","ngForOf"],[3,"ngSwitch","ngClass"],["ngSwitchCase","number"],["ngSwitchCase","name"],["ngSwitchCase","code"],["ngSwitchCase","time"],["ngSwitchCase","bestlap"],["ngSwitchCase","gap"],["ngSwitchCase","int"],["ngSwitchCase","lastlap"],["ngSwitchCase","sector1"],["ngSwitchCase","sector2"],["ngSwitchCase","sector3"],["ngSwitchCase","laps"],["ngSwitchCase","pits"],["ngSwitchCase","fuel"],["ngSwitchCase","status"],[3,"ngSwitch"],["ngSwitchCase",""],["ngSwitchCase","0"],["ngSwitchCase","1"],["ngSwitchDefault",""],[3,"ngClass"],[3,"max","value"],[3,"cols","rows",4,"ngIf"],[3,"ngClass",4,"ngIf"],[3,"cols","rows"]],template:function(o,r){o&1&&(c(0,"outline",0),g(1),d(),P(2,Il,16,4,"div",1)),o&2&&(p("color",r.item.driver==null?null:r.item.driver.color),a(),W(" ",r.item.position+1,`
`),a(),p("ngForOf",r.fields))},dependencies:[qe,Ie,we,it,ot,Yn,pi,Or,St,wn],styles:['@charset "UTF-8";@media (orientation: portrait){[_nghost-%COMP%]{font-size:3vw}}@media (orientation: landscape){[_nghost-%COMP%]{font-size:2.5vw}ion-modal   [_nghost-%COMP%]{font-size:1.5em!important}}[_nghost-%COMP%]{display:block;width:100%}leaderboard-head[_ngcontent-%COMP%]{margin:0 2px}leaderboard-item[_ngcontent-%COMP%]{margin:0 2px 4px}leaderboard-lap[_ngcontent-%COMP%]{margin:0 2px 4px}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;width:100%}.row.odd[_ngcontent-%COMP%]{background-color:var(--ion-color-step-100)}.row.even[_ngcontent-%COMP%]{background-color:var(--ion-color-step-200)}.cell[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:1;padding:.25em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.position[_ngcontent-%COMP%]{text-align:left;width:1.9em;padding-left:0!important;padding-right:0!important}.number[_ngcontent-%COMP%]{text-align:left;width:1.65em}.lap[_ngcontent-%COMP%]{text-align:left;width:2.5em}.name[_ngcontent-%COMP%]{flex-basis:4em;flex-grow:1;text-align:left}.code[_ngcontent-%COMP%]{flex-basis:3em;flex-grow:1;text-align:left}.time[_ngcontent-%COMP%]{text-align:right;width:6em}.bestlap[_ngcontent-%COMP%], .lastlap[_ngcontent-%COMP%], .laptime[_ngcontent-%COMP%]{text-align:right;width:5em}.sector1[_ngcontent-%COMP%], .sector2[_ngcontent-%COMP%], .sector3[_ngcontent-%COMP%]{text-align:right;width:4.5em}.gap[_ngcontent-%COMP%], .int[_ngcontent-%COMP%]{text-align:right;width:5em}.laps[_ngcontent-%COMP%], .pits[_ngcontent-%COMP%]{text-align:right;width:3em}.fuel[_ngcontent-%COMP%]{text-align:left;width:4.5em}.status[_ngcontent-%COMP%]{padding-right:0!important;text-align:left;width:2em}.status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:75%}.status[_ngcontent-%COMP%]   span.inpit[_ngcontent-%COMP%]{color:#fff}.status[_ngcontent-%COMP%]   span.pitenter[_ngcontent-%COMP%]{color:#ff4500}.status[_ngcontent-%COMP%]   span.pos-up[_ngcontent-%COMP%]{color:#0f0}.status[_ngcontent-%COMP%]   span.pos-up[_ngcontent-%COMP%]:before{content:"\\25b2";display:inline-block;width:1em}.status[_ngcontent-%COMP%]   span.pos-dn[_ngcontent-%COMP%]{color:#ff4500}.status[_ngcontent-%COMP%]   span.pos-dn[_ngcontent-%COMP%]:before{content:"\\25bc";display:inline-block;width:1em}.status[_ngcontent-%COMP%]   span.pos-eq[_ngcontent-%COMP%]{color:#fff}.status[_ngcontent-%COMP%]   span.pos-eq[_ngcontent-%COMP%]:before{content:"\\25b2";transform:rotate(-90deg);display:inline-block;width:1em}span.title[_ngcontent-%COMP%]{font-size:75%}span.best[_ngcontent-%COMP%]{color:#0f0}span.best.allbest[_ngcontent-%COMP%]{color:#f0f}span.best.notime[_ngcontent-%COMP%], span.best.allbest.notime[_ngcontent-%COMP%]{color:inherit}span.sector[_ngcontent-%COMP%]{color:#ff0!important}gauge[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:linear-gradient(to right,red,#ee0 25%,green 50%,#006400)}'],changeDetection:0});let t=e;return t})();var Ml=t=>[t,"cell"],ki=(t,e)=>({best:t,allbest:e});function Ol(t,e){if(t&1&&g(0),t&2){let i=b(2);W(" ",i.lap," ")}}function Pl(t,e){if(t&1&&(c(0,"span",10),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",nn(5,ki,i.times[0]-i.times[1]==i.item.best[0],i.times[0]-i.times[1]==i.best[0])),a(),W(" ",le(2,2,i.times[0]-i.times[1],"s.sss")," ")}}function Dl(t,e){if(t&1&&(g(0),x(1,"time")),t&2){let i=b(2);W(" ",le(1,1,i.times[0]-i.times[1]-i.best[0]||null,"+s.sss")," ")}}function Rl(t,e){if(t&1&&(g(0),x(1,"time")),t&2){let i=b(2);W(" ",le(1,1,i.times[0]-i.times[1]-i.intlap||null,"+s.sss")," ")}}function Ll(t,e){if(t&1&&(c(0,"span",10),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",nn(5,ki,i.times[2]-i.times[1]==i.item.best[1],i.times[2]-i.times[1]==i.best[1])),a(),W(" ",le(2,2,i.times[2]-i.times[1],"s.sss")," ")}}function Nl(t,e){if(t&1&&(c(0,"span",10),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",nn(5,ki,i.times[3]-i.times[2]==i.item.best[2],i.times[3]-i.times[2]==i.best[2])),a(),W(" ",le(2,2,i.times[3]-i.times[2],"s.sss")," ")}}function Fl(t,e){if(t&1&&(c(0,"span",10),g(1),x(2,"time"),d()),t&2){let i=b(2);p("ngClass",nn(5,ki,i.times[0]-i.times[3]==i.item.best[3],i.times[0]-i.times[3]==i.best[3])),a(),W(" ",le(2,2,i.times[0]-i.times[3],"s.sss")," ")}}function Al(t,e){if(t&1&&R(0,"span",10),t&2){let i=b(3);p("ngClass",i.last[0]-i.last[1]>i.times[0]-i.times[1]?"pos-up":"pos-dn")}}function Bl(t,e){if(t&1&&P(0,Al,1,1,"span",11),t&2){let i=b(2);p("ngIf",i.last)}}function jl(t,e){if(t&1&&(c(0,"div",1),P(1,Ol,1,1,"ng-template",2)(2,Pl,3,8,"ng-template",3)(3,Dl,2,4,"ng-template",4)(4,Rl,2,4,"ng-template",5)(5,Ll,3,8,"ng-template",6)(6,Nl,3,8,"ng-template",7)(7,Fl,3,8,"ng-template",8)(8,Bl,1,1,"ng-template",9),d()),t&2){let i=e.$implicit;p("ngSwitch",i)("ngClass",ve(2,Ml,i))}}var Ts=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=ie({type:e,selectors:[["leaderboard-lap"]],inputs:{lap:"lap",item:"item",times:"times",best:"best",last:"last",intlap:"intlap",fields:"fields"},standalone:!1,decls:1,vars:1,consts:[[3,"ngSwitch","ngClass",4,"ngFor","ngForOf"],[3,"ngSwitch","ngClass"],["ngSwitchCase","lap"],["ngSwitchCase","laptime"],["ngSwitchCase","gap"],["ngSwitchCase","int"],["ngSwitchCase","sector1"],["ngSwitchCase","sector2"],["ngSwitchCase","sector3"],["ngSwitchCase","status"],[3,"ngClass"],[3,"ngClass",4,"ngIf"]],template:function(o,r){o&1&&P(0,jl,9,4,"div",0),o&2&&p("ngForOf",r.fields)},dependencies:[qe,Ie,we,it,ot,wn],styles:['@charset "UTF-8";@media (orientation: portrait){[_nghost-%COMP%]{font-size:3vw}}@media (orientation: landscape){[_nghost-%COMP%]{font-size:2.5vw}ion-modal   [_nghost-%COMP%]{font-size:1.5em!important}}[_nghost-%COMP%]{display:block;width:100%}leaderboard-head[_ngcontent-%COMP%]{margin:0 2px}leaderboard-item[_ngcontent-%COMP%]{margin:0 2px 4px}leaderboard-lap[_ngcontent-%COMP%]{margin:0 2px 4px}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;width:100%}.row.odd[_ngcontent-%COMP%]{background-color:var(--ion-color-step-100)}.row.even[_ngcontent-%COMP%]{background-color:var(--ion-color-step-200)}.cell[_ngcontent-%COMP%]{flex-grow:0;flex-shrink:1;padding:.25em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.position[_ngcontent-%COMP%]{text-align:left;width:1.9em;padding-left:0!important;padding-right:0!important}.number[_ngcontent-%COMP%]{text-align:left;width:1.65em}.lap[_ngcontent-%COMP%]{text-align:left;width:2.5em}.name[_ngcontent-%COMP%]{flex-basis:4em;flex-grow:1;text-align:left}.code[_ngcontent-%COMP%]{flex-basis:3em;flex-grow:1;text-align:left}.time[_ngcontent-%COMP%]{text-align:right;width:6em}.bestlap[_ngcontent-%COMP%], .lastlap[_ngcontent-%COMP%], .laptime[_ngcontent-%COMP%]{text-align:right;width:5em}.sector1[_ngcontent-%COMP%], .sector2[_ngcontent-%COMP%], .sector3[_ngcontent-%COMP%]{text-align:right;width:4.5em}.gap[_ngcontent-%COMP%], .int[_ngcontent-%COMP%]{text-align:right;width:5em}.laps[_ngcontent-%COMP%], .pits[_ngcontent-%COMP%]{text-align:right;width:3em}.fuel[_ngcontent-%COMP%]{text-align:left;width:4.5em}.status[_ngcontent-%COMP%]{padding-right:0!important;text-align:left;width:2em}.status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:75%}.status[_ngcontent-%COMP%]   span.inpit[_ngcontent-%COMP%]{color:#fff}.status[_ngcontent-%COMP%]   span.pitenter[_ngcontent-%COMP%]{color:#ff4500}.status[_ngcontent-%COMP%]   span.pos-up[_ngcontent-%COMP%]{color:#0f0}.status[_ngcontent-%COMP%]   span.pos-up[_ngcontent-%COMP%]:before{content:"\\25b2";display:inline-block;width:1em}.status[_ngcontent-%COMP%]   span.pos-dn[_ngcontent-%COMP%]{color:#ff4500}.status[_ngcontent-%COMP%]   span.pos-dn[_ngcontent-%COMP%]:before{content:"\\25bc";display:inline-block;width:1em}.status[_ngcontent-%COMP%]   span.pos-eq[_ngcontent-%COMP%]{color:#fff}.status[_ngcontent-%COMP%]   span.pos-eq[_ngcontent-%COMP%]:before{content:"\\25b2";transform:rotate(-90deg);display:inline-block;width:1em}span.title[_ngcontent-%COMP%]{font-size:75%}span.best[_ngcontent-%COMP%]{color:#0f0}span.best.allbest[_ngcontent-%COMP%]{color:#f0f}span.best.notime[_ngcontent-%COMP%], span.best.allbest.notime[_ngcontent-%COMP%]{color:inherit}span.sector[_ngcontent-%COMP%]{color:#ff0!important}gauge[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:linear-gradient(to right,red,#ee0 25%,green 50%,#006400)}'],changeDetection:0});let t=e;return t})();var Ss=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Ee({imports:[rt,Xe,ut]});let t=e;return t})();Fo(Ei,[qe,Ie,Ge,$e,Ye,st,at,lt,Qe,ai,St,xs,ws,Ts],[Ke]);var Es=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Ee({imports:[rt,Xe]});let t=e;return t})();var ks=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Ee({imports:[rt,_n,Ko,Xe,Ss,Es,ut]});let t=e;return t})();var Is=(()=>{let e=class e{get mode(){return this.options.cumode}set mode(n){this.options.cumode=n,this.settings.setOptions(this.options),this.dismiss()}constructor(n,o,r,s){this.logger=n,this.settings=o,this.controller=r,this.options=new ui,this.params=s.data}ngOnInit(){this.subscription=this.settings.getOptions().subscribe({next:n=>{this.options=n},error:n=>{this.logger.error("Tuning settings: ",n)},complete:()=>{this.logger.debug("Tuning settings complete")}})}ngOnDestroy(){this.subscription.unsubscribe()}applyAll(){this.params.apply(),this.dismiss()}dismiss(){return this.controller.dismiss()}};e.\u0275fac=function(o){return new(o||e)(E(be),E(Be),E(Qt),E($t))},e.\u0275cmp=ie({type:e,selectors:[["ng-component"]],standalone:!1,decls:8,vars:1,consts:[["translate","",3,"ngModelChange","ngModel"],["button","",3,"click"],["translate",""]],template:function(o,r){o&1&&(c(0,"ion-item-group")(1,"ion-item")(2,"ion-checkbox",0),zt("ngModelChange",function(m){return qt(r.mode,m)||(r.mode=m),m}),g(3,"Control Unit mode"),d()(),c(4,"ion-item",1),A("click",function(){return r.applyAll()}),c(5,"ion-label")(6,"span",2),g(7,"Apply all"),d()()()()),o&2&&(a(2),Zt("ngModel",r.mode))},dependencies:[wt,Gt,ti,Fe,Cn,ct,bn,Ae],encapsulation:2});let t=e;return t})();var Vl=t=>({number:t}),kn=t=>({pristine:t});function Ul(t,e){if(t&1&&(c(0,"ion-label"),g(1),x(2,"translate"),d()),t&2){let i=b().$implicit,n=b().ngIf,o=b();a(),W(" ",(n[i.id]==null?null:n[i.id].name)||le(2,1,o.placeholder,ve(4,Vl,i.id+1))," ")}}function Wl(t,e){if(t&1&&(c(0,"ion-label"),g(1),d()),t&2){let i=b().$implicit,n=b().ngIf;a(),W(" ",(n[i.id]==null?null:n[i.id].code)||"#"+(i.id+1)," ")}}function Hl(t,e){if(t&1){let i=de();c(0,"ion-range",16),x(1,"async"),A("ionChange",function(o){te(i);let r=b(2).$implicit,s=b(2);return ne(s.update("speed",o,s.locked?void 0:r.id))}),c(2,"ion-badge",17),g(3),d()()}if(t&2){let i=b(2).$implicit,n=b(2);p("disabled",!M(1,5,n.connected))("ngClass",ve(7,kn,i.speed==null))("value",i.speed),a(2),p("color",i.speed==null?"medium":"primary"),a(),W(" ",i.speed==null?"?":i.speed," ")}}function Zl(t,e){if(t&1){let i=de();c(0,"ion-range",16),x(1,"async"),A("ionChange",function(o){te(i);let r=b(2).$implicit,s=b(2);return ne(s.update("brake",o,s.locked?void 0:r.id))}),c(2,"ion-badge",17),g(3),d()()}if(t&2){let i=b(2).$implicit,n=b(2);p("disabled",!M(1,5,n.connected))("ngClass",ve(7,kn,i.brake==null))("value",i.brake),a(2),p("color",i.brake==null?"medium":"primary"),a(),W(" ",i.brake==null?"?":i.brake," ")}}function ql(t,e){if(t&1){let i=de();c(0,"ion-range",16),x(1,"async"),A("ionChange",function(o){te(i);let r=b(2).$implicit,s=b(2);return ne(s.update("fuel",o,s.locked?void 0:r.id))}),c(2,"ion-badge",17),g(3),d()()}if(t&2){let i=b(2).$implicit,n=b(2);p("disabled",!M(1,5,n.connected))("ngClass",ve(7,kn,i.fuel==null))("value",i.fuel),a(2),p("color",i.fuel==null?"medium":"primary"),a(),W(" ",i.fuel==null?"?":i.fuel," ")}}function zl(t,e){if(t&1&&(yt(0)(1,13),P(2,Hl,4,9,"ion-range",15)(3,Zl,4,9,"ion-range",15)(4,ql,4,9,"ion-range",15),xt()()),t&2){let i=b(3);a(),p("ngSwitch",i.type),a(),p("ngSwitchCase","speed"),a(),p("ngSwitchCase","brake"),a(),p("ngSwitchCase","fuel")}}function Gl(t,e){if(t&1){let i=de();c(0,"ion-range",19),x(1,"async"),A("ionChange",function(o){te(i);let r=b(2).$implicit,s=b(2);return ne(s.updateCU("speed",o,s.locked?void 0:r.id))}),c(2,"ion-badge",17),g(3),d()()}if(t&2){let i=b(2).$implicit,n=b(2);p("disabled",!M(1,5,n.connected))("ngClass",ve(7,kn,i.speed==null))("value",n.toCU.speed[i.speed]),a(2),p("color",i.speed==null?"medium":"primary"),a(),W(" ",i.speed==null?"?":n.toCU.speed[i.speed]," ")}}function $l(t,e){if(t&1){let i=de();c(0,"ion-range",19),x(1,"async"),A("ionChange",function(o){te(i);let r=b(2).$implicit,s=b(2);return ne(s.updateCU("brake",o,s.locked?void 0:r.id))}),c(2,"ion-badge",17),g(3),d()()}if(t&2){let i=b(2).$implicit,n=b(2);p("disabled",!M(1,5,n.connected))("ngClass",ve(7,kn,i.brake==null))("value",n.toCU.brake[i.brake]),a(2),p("color",i.brake==null?"medium":"primary"),a(),W(" ",i.brake==null?"?":n.toCU.brake[i.brake]," ")}}function Yl(t,e){if(t&1){let i=de();c(0,"ion-range",19),x(1,"async"),A("ionChange",function(o){te(i);let r=b(2).$implicit,s=b(2);return ne(s.updateCU("fuel",o,s.locked?void 0:r.id))}),c(2,"ion-badge",17),g(3),d()()}if(t&2){let i=b(2).$implicit,n=b(2);p("disabled",!M(1,5,n.connected))("ngClass",ve(7,kn,i.fuel==null))("value",n.toCU.fuel[i.fuel]),a(2),p("color",i.fuel==null?"medium":"primary"),a(),W(" ",i.fuel==null?"?":n.toCU.fuel[i.fuel]," ")}}function Ql(t,e){if(t&1&&(yt(0)(1,13),P(2,Gl,4,9,"ion-range",18)(3,$l,4,9,"ion-range",18)(4,Yl,4,9,"ion-range",18),xt()()),t&2){let i=b(3);a(),p("ngSwitch",i.type),a(),p("ngSwitchCase","speed"),a(),p("ngSwitchCase","brake"),a(),p("ngSwitchCase","fuel")}}function Xl(t,e){if(t&1&&(c(0,"ion-item")(1,"outline",12),g(2),d(),yt(3,13),x(4,"async"),P(5,Ul,3,6,"ion-label",14)(6,Wl,2,1,"ion-label",14),xt(),yt(7,13),x(8,"async"),P(9,zl,5,4,"ng-container",14)(10,Ql,5,4,"ng-container",14),xt(),d()),t&2){let i,n=e.$implicit,o=b().ngIf,r=b();a(),p("color",o[n.id]==null?null:o[n.id].color),a(),W(" ",n.id+1," "),a(),p("ngSwitch",M(4,8,r.orientation)),a(2),p("ngSwitchCase","landscape"),a(),p("ngSwitchCase","portrait"),a(),p("ngSwitch",(i=M(8,10,r.options))==null?null:i.cumode),a(2),p("ngSwitchCase",!1),a(),p("ngSwitchCase",!0)}}function Kl(t,e){if(t&1&&(yt(0),P(1,Xl,11,12,"ion-item",11),xt()),t&2){let i=b();a(),p("ngForOf",i.models)}}var Jl=[0,1,2,3,4,5].map(t=>({id:t,speed:null,brake:null,fuel:null})),Ii=(()=>{let e=class e{constructor(n,o,r,s,m,l){this.logger=n,this.cu=o,this.popover=r,this.ref=s,this.models=Jl,this.locked=!1,this.type="speed",this.placeholder="Driver {{number}}",this.fromCU={speed:[0,1,2,3,5,6,7,9,11,13,15],brake:[0,6,7,8,9,10,11,12,13,14,15],fuel:[0,3,4,5,6,7,8,9,10,11,12]},this.toCU={speed:[1,1,2,3,3,4,5,6,6,7,7,8,8,9,9,10],brake:[1,1,1,1,1,1,1,2,3,4,5,6,7,8,9,10],fuel:[1,1,1,1,2,3,4,5,6,7,8,9,10,10,10,10]},this.subject=new Ze,this.connected=o.pipe(se(_=>!!_),De(_=>_.getState()),F(_=>_=="connected")),this.drivers=l.getDrivers(),this.options=l.getOptions(),this.orientation=m.orientation}ngOnInit(){this.subject.pipe(_o(400)).subscribe(n=>{for(let o of n.id!==void 0?[this.models[n.id]]:this.models)switch(n.type){case"speed":this.cu.value.setSpeed(o.id,o.speed);break;case"brake":this.cu.value.setBrake(o.id,o.brake);break;case"fuel":this.cu.value.setFuel(o.id,o.fuel);break}})}ngOnDestroy(){this.subject.complete()}applyAll(){for(let n of this.models)n.speed!==null&&this.cu.value.setSpeed(n.id,n.speed),n.brake!==null&&this.cu.value.setBrake(n.id,n.brake),n.fuel!==null&&this.cu.value.setFuel(n.id,n.fuel)}showMenu(n){return this.popover.create({component:Is,componentProps:{apply:()=>this.applyAll()},event:n}).then(o=>{o.present()})}update(n,o,r){let s=o.detail.value;this.logger.debug("Set",n,"to",s,"for",r);for(let m of r!==void 0?[this.models[r]]:this.models)m[n]=s;this.subject.next({id:r,type:n}),this.ref.detectChanges()}updateCU(n,o,r){let s=o.detail.value;switch(n){case"speed":s=this.fromCU.speed[o.detail.value];break;case"brake":s=this.fromCU.brake[o.detail.value];break;case"fuel":s=this.fromCU.fuel[o.detail.value];break}this.logger.debug("Set",n,"to",s,"for",r);for(let m of r!==void 0?[this.models[r]]:this.models)m[n]=s;this.subject.next({id:r,type:n}),this.ref.detectChanges()}};e.\u0275fac=function(o){return new(o||e)(E(be),E(Xt),E(Qt),E($n),E(pt),E(Be))},e.\u0275cmp=ie({type:e,selectors:[["ng-component"]],standalone:!1,decls:29,vars:17,consts:[["slot","start"],["defaultHref","/"],["slot","end"],[3,"click"],["slot","icon-only",3,"name"],["slot","icon-only","name","ellipsis-vertical-sharp"],[3,"ngModelChange","ngModel"],["value","speed"],["value","brake"],["value","fuel"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","start",3,"color"],[3,"ngSwitch"],[4,"ngSwitchCase"],["min","0","max","15","snaps","true","aria-label","",3,"disabled","ngClass","value","ionChange",4,"ngSwitchCase"],["min","0","max","15","snaps","true","aria-label","",3,"ionChange","disabled","ngClass","value"],["slot","end",1,"tuning",3,"color"],["min","1","max","10","snaps","true","aria-label","",3,"disabled","ngClass","value","ionChange",4,"ngSwitchCase"],["min","1","max","10","snaps","true","aria-label","",3,"ionChange","disabled","ngClass","value"]],template:function(o,r){o&1&&(c(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),R(3,"ion-back-button",1),d(),c(4,"ion-title")(5,"span"),g(6),x(7,"translate"),d()(),c(8,"ion-buttons",2)(9,"ion-button",3),A("click",function(){return r.locked=!r.locked}),R(10,"ion-icon",4),d(),c(11,"ion-button",3),A("click",function(m){return r.showMenu(m)}),R(12,"ion-icon",5),d()()()(),c(13,"ion-content")(14,"ion-segment",6),zt("ngModelChange",function(m){return qt(r.type,m)||(r.type=m),m}),c(15,"ion-segment-button",7)(16,"ion-label"),g(17),x(18,"translate"),d()(),c(19,"ion-segment-button",8)(20,"ion-label"),g(21),x(22,"translate"),d()(),c(23,"ion-segment-button",9)(24,"ion-label"),g(25),x(26,"translate"),d()()(),P(27,Kl,2,1,"ng-container",10),x(28,"async"),d()),o&2&&(a(6),me(M(7,7,"Tuning")),a(4),p("name",r.locked?"link-sharp":"unlink-sharp"),a(4),Zt("ngModel",r.type),a(3),me(M(18,9,"Speed")),a(4),me(M(22,11,"Brake")),a(4),me(M(26,13,"Fuel")),a(2),p("ngIf",M(28,15,r.drivers)))},dependencies:[qe,Ie,we,it,ot,wt,Gt,ei,Ge,$e,Ye,st,at,Fe,ct,ri,ur,dr,lt,Qe,Xn,Kn,si,St,ze,Ke],encapsulation:2});let t=e;return t})();var Ms=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Ee({imports:[rt,_n,Xe,ut]});let t=e;return t})();function ep(t,e){if(t&1&&(c(0,"h3")(1,"span",5),g(2,"Firmware version"),d(),g(3),x(4,"async"),x(5,"cuversion"),d()),t&2){let i=b();a(3),W(" ",M(5,3,M(4,1,i.version))," ")}}function tp(t,e){if(t&1){let i=de();c(0,"ion-item",18),A("click",function(){te(i);let o=b(2);return ne(o.exitApp())}),R(1,"ion-icon",19),c(2,"ion-label"),g(3),x(4,"translate"),d()()}t&2&&(a(3),me(M(4,1,"Exit")))}function np(t,e){if(t&1){let i=de();c(0,"div")(1,"ion-item-group")(2,"ion-menu-toggle",6)(3,"ion-item",7),A("click",function(){te(i);let o=b();return ne(o.startPractice())}),R(4,"ion-icon",8),c(5,"ion-label"),g(6),x(7,"translate"),d()(),c(8,"ion-item",7),A("click",function(){te(i);let o=b();return ne(o.startQualifying())}),R(9,"ion-icon",9),c(10,"ion-label"),g(11),x(12,"translate"),d()(),c(13,"ion-item",7),A("click",function(){te(i);let o=b();return ne(o.startRace())}),R(14,"ion-icon",10),c(15,"ion-label"),g(16),x(17,"translate"),d()()()(),c(18,"ion-item-group")(19,"ion-menu-toggle",6)(20,"ion-item",11),R(21,"ion-icon",12),c(22,"ion-label"),g(23),x(24,"translate"),d()(),c(25,"ion-item",13),R(26,"ion-icon",14),c(27,"ion-label"),g(28),x(29,"translate"),d()()()(),c(30,"ion-item-group")(31,"ion-menu-toggle",6)(32,"ion-item",15),R(33,"ion-icon",16),c(34,"ion-label"),g(35),x(36,"translate"),d()(),P(37,tp,5,3,"ion-item",17),d()()()}if(t&2){let i=b();a(3),p("disabled",!i.cu),a(3),me(M(7,11,"Free Practice")),a(2),p("disabled",!i.cu),a(3),me(M(12,13,"Qualifying")),a(2),p("disabled",!i.cu),a(3),me(M(17,15,"Race")),a(7),me(M(24,17,"Drivers")),a(2),p("disabled",!i.cu),a(3),me(M(29,19,"Tuning")),a(7),me(M(36,21,"Settings")),a(2),p("ngIf",i.exitApp)}}function ip(t,e){if(t&1&&(c(0,"ion-item-group"),R(1,"connections",20),d()),t&2){let i=b(2);a(),p("selected",i.cu==null?null:i.cu.peripheral)}}function op(t,e){if(t&1){let i=de();c(0,"ion-item-group")(1,"ion-item",18),A("click",function(){te(i);let o=b(2);return ne(o.reconnect())}),R(2,"ion-icon",21),c(3,"ion-label"),g(4),x(5,"translate"),d()()()}t&2&&(a(4),me(M(5,1,"Reconnect")))}function rp(t,e){if(t&1&&(c(0,"div"),P(1,ip,2,1,"ion-item-group",3)(2,op,6,3,"ion-item-group",3),d()),t&2){let i=b();a(),p("ngIf",i.open),a(),p("ngIf",i.cu)}}var Os=(()=>{let e=class e{constructor(n,o,r,s,m,l){this.app=n,this.logger=o,this.settings=r,this.alert=s,this.mod=m,this.nav=l,this.exitApp=null,this.driversPage=wi,this.tuningPage=Ii,this.settingsPage=Pr,this.initialized=!1,n.exit&&(this.exitApp=()=>this.onExitApp())}ngOnChanges(n){"cu"in n&&(this.mode=!!this.cu,this.version=this.cu?this.cu.getVersion():Promise.resolve(void 0))}onMenuOpen(){!this.initialized&&this.connections&&(navigator.bluetooth&&this.connections.ngOnInit(),this.initialized=!0),this.open=!0}onMenuClose(){this.mode=!!this.cu,this.open=!1}onMenuToggle(){this.mode=!this.mode}reconnect(){this.cu&&(this.logger.info("Reconnecting to",this.cu.peripheral),this.cu.reconnect().then(()=>{this.version=this.cu.getVersion()}))}startPractice(){return this.nav.navigateRoot("rms/practice")}startQualifying(){this.settings.getQualifyingSettings().pipe(Ce(1)).subscribe(n=>this.mod.create({component:ro,componentProps:n}).then(o=>{o.onDidDismiss().then(r=>{r.data&&this.settings.setQualifyingSettings(r.data).then(()=>{this.nav.navigateRoot("rms/qualifying")})}),o.present()}))}startRace(){this.settings.getRaceSettings().pipe(Ce(1)).subscribe(n=>this.mod.create({component:ro,componentProps:n}).then(o=>{o.onDidDismiss().then(r=>{r.data&&this.settings.setRaceSettings(r.data).then(()=>{this.nav.navigateRoot("rms/race")})}),o.present()}))}onExitApp(){this.alert.show({message:"Exit Open Lap?",buttons:[{text:"Cancel",role:"cancel"},{text:"OK",handler:()=>this.exit()}]})}exit(){this.logger.info("Exiting application"),this.cu?this.cu.disconnect().catch(n=>{this.logger.error("Error disconnecting from CU:",n)}).then(()=>{this.app.exit()}):this.app.exit(),this.logger.info("Exited application")}};e.\u0275fac=function(o){return new(o||e)(E(pt),E(be),E(Be),E(yn),E(Yt),E(Jo))},e.\u0275cmp=ie({type:e,selectors:[["menu"]],viewQuery:function(o,r){if(o&1&&Rt(Ti,5),o&2){let s;Lt(s=Nt())&&(r.connections=s.first)}},inputs:{cu:"cu"},standalone:!1,features:[qn],decls:14,vars:9,consts:[["contentId","menu-content",3,"ionDidClose","ionDidOpen"],["lines","none"],[3,"click","color"],[4,"ngIf"],["slot","end",3,"name"],["translate",""],["auto-hide","false"],["button","",3,"click","disabled"],["name","speedometer-sharp","slot","start"],["name","stopwatch-sharp","slot","start"],["name","trophy-sharp","slot","start"],["button","","routerLink","/drivers"],["name","people-sharp","slot","start"],["button","","routerLink","/tuning",3,"disabled"],["name","build-sharp","slot","start"],["button","","routerLink","/settings"],["menuClose","","name","settings-sharp","slot","start"],["button","",3,"click",4,"ngIf"],["button","",3,"click"],["name","exit-sharp","slot","start"],[3,"selected"],["name","refresh-sharp","slot","start"]],template:function(o,r){o&1&&(c(0,"ion-menu",0),A("ionDidClose",function(){return r.onMenuClose()})("ionDidOpen",function(){return r.onMenuOpen()}),c(1,"ion-content")(2,"ion-list",1)(3,"ion-item",2),A("click",function(){return r.onMenuToggle()}),c(4,"ion-label")(5,"h1"),g(6),x(7,"translate"),d(),c(8,"h2"),g(9),d(),P(10,ep,6,5,"h3",3),d(),R(11,"ion-icon",4),d(),P(12,np,38,23,"div",3)(13,rp,3,2,"div",3),d()()()),o&2&&(a(3),p("color",r.cu?"primary":"danger"),a(3),me(r.cu?r.cu.peripheral.name:M(7,7,"No connection")),a(3),me(r.cu==null?null:r.cu.peripheral.address),a(),p("ngIf",r.cu),a(),p("name",r.mode?"caret-down-sharp":"caret-up-sharp"),a(),p("ngIf",r.mode),a(),p("ngIf",!r.mode))},dependencies:[we,Ae,Ye,at,Fe,Cn,ct,oi,or,sr,_r,Zo,Ti,ze,Ke,ds],encapsulation:2});let t=e;return t})();var ap=[{path:"",redirectTo:"rms/practice",pathMatch:"full"},{path:"rms/:mode",component:no},{path:"drivers",component:wi},{path:"tuning",component:Ii},{path:"settings",loadChildren:()=>import("./chunk-QOBXWXVV.js").then(t=>t.SettingsModule)},{path:"**",component:no}],Mi=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Ee({imports:[Ai.forRoot(ap,{preloadingStrategy:qo,useHash:!0}),Ai]});let t=e;return t})();var Ps=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e}),e.\u0275inj=Ee({imports:[rt,ut,Xe,Mi]});let t=e;return t})();var cp=3e3,lp={connected:"Connected to {{device}}",connecting:"Connecting to {{device}}",disconnected:"Disconnected from {{device}}"},Ds=(()=>{let e=class e{constructor(n,o,r,s,m,l,_,y,I,C){this.app=n,this.cu=o,this.backends=r,this.alert=s,this.logger=m,this.settings=l,this.speech=_,this.toast=y,this.translate=I,this.swUpdate=C,this.stateSubscription=new pn,window.screen&&(window.screen.orientation.addEventListener("change",()=>{n.enableFullScreen(window.screen.orientation.type.startsWith("landscape"))}),window.screen.orientation&&window.screen.orientation.type&&n.enableFullScreen(window.screen.orientation.type.startsWith("landscape"))),n.keepAwake(!0),I.setDefaultLang("en")}ngOnInit(){this.app.getVersion().then(n=>{this.app.getVersionCode().then(o=>{o&&(n+=" ("+o+")"),this.logger.info("Open Lap",n,Ni()?"[dev]":"[prod]","on",window?.navigator?.userAgent),Ni})}),this.settings.getOptions().subscribe(n=>{this.logger.setDebugEnabled(n.debug),this.setLanguage(n.language),this.speech.setVoice(n.voice),this.speech.setRate(n.rate/1e3),this.speech.setPitch(n.pitch/1e3)})}ngOnDestroy(){this.cu.next(null)}ngAfterViewInit(){this.swUpdate.isEnabled?(this.logger.info("Service worker enabled"),this.swUpdate.versionUpdates.subscribe(n=>{n&&n.type==="NO_NEW_VERSION_DETECTED"?this.logger.info("No new version detected"):n&&n.type==="VERSION_DETECTED"?this.logger.info("New Version detected"):n&&n.type==="VERSION_READY"?(this.logger.info("Version update ready"),this.update()):this.logger.error("Version event:",n)})):this.logger.debug("Service worker not enabled"),new Promise(n=>setTimeout(n,100)).then(()=>{this.connect()})}update(){this.alert.show({message:"A new version of Open Lap is available. Do you want to update now?",buttons:[{text:"Cancel",role:"cancel"},{text:"OK",handler:()=>document.location.reload()}]})}setLanguage(n){this.translate.use(n||this.translate.getBrowserLang()||"en").toPromise().then(o=>{this.translate.get("notifications.locale").toPromise().then(r=>{this.speech.setLocale(r)})})}showConnectionToast(n,o){let r=lp[n]||"Connecting to {{device}}";this.toast.showShortCenter(r,{device:o}).catch(s=>{this.logger.error("Error showing toast",s)})}connect(){this.settings.getConnection().subscribe(n=>{this.stateSubscription.unsubscribe(),n&&n.name?(this.logger.info("Connecting to "+n.name),Ne(this.backends.map(o=>o.scan())).pipe(et(o=>o),vo(o=>o.equals(n)),jn(cp)).toPromise().then(o=>{let r=new vi(o,n);this.stateSubscription=r.getState().subscribe(s=>this.showConnectionToast(s,r.peripheral.name)),this.cu.next(r),r.connect()}).catch(o=>{this.logger.error("Error connecting to "+n.name+":",o)}).then(()=>{this.app.hideSplashScreen()})):(this.app.hideSplashScreen(),this.cu.next(null))})}};e.\u0275fac=function(o){return new(o||e)(E(pt),E(Xt),E(Oe),E(yn),E(be),E(Be),E(xn),E(li),E(vn),E(_i))},e.\u0275cmp=ie({type:e,selectors:[["app-root"]],standalone:!1,decls:4,vars:3,consts:[[3,"cu"],["main","","id","menu-content"]],template:function(o,r){o&1&&(c(0,"ion-app"),R(1,"menu",0),x(2,"async"),R(3,"ion-router-outlet",1),d()),o&2&&(a(),p("cu",M(2,1,r.cu)))},dependencies:[tr,gr,Os,ze],encapsulation:2});let t=e;return t})();var Oi={production:!0};var pp=(()=>{let e=class e{constructor(n){this.logger=n}handleError(n){this.logger.error("Error:",n)}};e.\u0275fac=function(o){return new(o||e)(Re(be))},e.\u0275prov=Se({token:e,factory:e.\u0275fac});let t=e;return t})();function up(t){return{enabled:!t.is("cordova")&&Oi.production,registrationStrategy:"registerImmediately"}}var Rs=(()=>{let e=class e{};e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=ke({type:e,bootstrap:[Ds]}),e.\u0275inj=Ee({providers:[br,Cr,bi,vr,yr,Ci,xr,wr,Tr,Sr,Er,{provide:Ho,useClass:er},{provide:Oo,useClass:pp},{provide:rn,useFactory:up,deps:[Tt]},Vo(Uo()),Mr({loader:Jr({prefix:"./assets/i18n/"}),fallbackLang:"en",lang:"de"})],imports:[jo,Xe.forRoot(),kr.forRoot(),ls,us,Ps,ks,ut,Ms,Mi,Kr.register("ngsw-worker.js")]});let t=e;return t})();Oi.production&&void 0;Bo().bootstrapModule(Rs).catch(t=>console.log(t));
